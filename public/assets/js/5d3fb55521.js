$(document).ready((function(){window.iCarFunctions.facets=function(){$(".smenu").length&&(window.iCarSMenu=new SMenu)},$("#classified-form-facets, #classified-facets-form-keyword").on("submit",(function(e){var a=$(this);if("failed"==a.attr("form-validation"))return e.preventDefault(),!1;if("classified-facets-form-keyword"==a.attr("id")){var t,i=a.serializeArray(),n={};for(f in i)n[i[f].name]=i[f].value;if(n.vehicle_type=a.attr("data-vehicle-type"),!(t=""!=(e=n.keyword.toLowerCase())&&void 0!==suggestions["used-by-name"][e]?suggestions["used-by-name"][e]:t))return!0;window.location.href=t}return a.find(":input").filter((function(){return!this.value})).attr("disabled","disabled"),!1})),$("#classified-form-facets").find(":input").prop("disabled",!1),$("#classified-form"),$(".js-classified-form__button-reset, .js-classified-form").on("click",(function(e){$(".js-form-error").addClass("visuallyhidden")})),$(".smenu").length&&window.iCarFunctions.facets()})),$(document).ready((function(){var e=$("#compare_listings .js-compare-notification"),a=$(".js-compare-basket"),t=("mobile"===window.adDevice?window.iCarAsiaParameters.mobile:window.iCarAsiaParameters).compareLimit,i=a.data("compare-type"),n=a.data("compare-basket-count"),r="mcycle"===i?"compare_mcycle":"compare";function s(){var e=$.cookie(r);return"undefined"!=e&&e?e.split(","):[]}function o(){$(".js-toggle-compare-basket").attr("disabled","disabled"),$.each(s(),(function(e,a){$('.js-toggle-compare-basket[value="'+a+'"]').removeAttr("disabled")}))}function l(e){var a=s();e=parseInt(e,10),-1<(e=a.indexOf(e+""))&&a.splice(e,1),0<a.length?$.cookie(r,a,{path:"/"}):$.removeCookie(r,{path:"/"})}function d(e){var i=parseInt($(".js-compare-basket-count").html(),10);l(e),0<i&&(0==--i&&(a.addClass("visuallyhidden u-hide"),$("body").removeClass("body__compare-basket--active")),i<t&&($("input.js-toggle-compare-basket").removeAttr("disabled"),$("#compare_listings .js-compare-notification").addClass("visuallyhidden u-hide")),$(".basket__listing--"+e).remove(),$(".js-compare-basket-count").html(i))}e.length&&e.html(e.data("notification-message").replace("{limit}",t)),t<=n&&e.removeClass("visuallyhidden u-hide"),window.iCarFunctions.compare=function(){s().length==t&&o(),$(".js-toggle-compare-basket").on("change",(function(e){e.preventDefault();var i=$(this),n=i.val(),l=$('input[name="'+i.attr("name")+'"]');e=$('input[name="'+i.attr("name")+'"]').closest(".c-item__compare");i.prop("checked")?(function(e){a.removeClass("visuallyhidden u-hide"),$("body").addClass("body__compare-basket--active");var i=s();e=parseInt(e,10);var n=parseInt($(".js-compare-basket-count").html(),10);if(i.length>=t||t<=n)return location.reload();var l=$('.js--listing[data-listing-id="'+e+'"]');i.indexOf(e+"")<0&&(i.push(e+""),$.cookie(r,i,{path:"/"}));var d=l.attr("data-url"),c=l.attr("data-compare-image"),u=l.attr("data-display-title"),p=iCarFunctions.decrypt(l.attr("data-price")),C=iCarFunctions.decrypt(l.attr("data-price-raw")),m=l.attr("data-installment"),h="true"==l.attr("data-hot-deal"),g="true"==$(".listing__installment").attr("data-show-installment"),f=l.attr("data-video");n++,$(".js-compare-basket-count").html(n),i='<div class="basket__listing  relative  basket__listing--'+e+'  u-hide">',i+='<article class="listing  listing--small  push--ends  '+(h?"media--hot-deal":"")+'">',i+='<div class="media  media--listing  push-half--top">',i+='<a class="media__img  one-third  push-half--right  relative" href="'+d+'">',i+=f,i+='<img src="'+c+'" alt="">',i+="</a>",i+='<div class="media__body">',i+='<h3 class="listing__title  media__title  zeta  weight--semibold  push-quarter--bottom  push--right"><a href="'+d+'">'+u+"</a></h3>",h?(i+='<div class="listing__price">',"true"==l.attr("data-hide-price")?(_=parseInt(l.attr("data-hide-price-hours"),10),v=parseInt(l.attr("data-hide-price-days"),10),w=l.attr("data-hide-price-hours-title"),b=l.attr("data-hide-price-days-title"),i+='<div class="hot-deal  hot-deal--time-left  weight--semibold">',i+='<span class="hot-deal__tip  weight--normal">'+l.attr("data-hide-price-title")+"</span>",i+='<div class="listing__price  listing__price--hot-deal  listing__timer  delta  weight--bold">',0<v&&(i+=v+' <span class="inline--block  valign--top  micro  weight--normal  text--uppercase">'+b+"</span>"),0<_&&(i+=" "+_+' <span class="inline--block  valign--top  micro  weight--normal  text--uppercase">'+w+"</span>"),i+="</div>",i+="</span>"):(T=l.attr("data-hot-deal-actual-price"),j=l.attr("data-hot-deal-actual-price-title"),i+='<div class="hot-deal  '+((R=0<(y=parseFloat(l.attr("data-hot-deal-discount")))&&0!=T)?"hot-deal--discount":"")+'">',R?(i+='<span class="weight--normal  line--through" x-ms-format-detection="none">'+T+"</span>",i+=' <span class="micro  line--inherit  text--muted" x-ms-format-detection="none">'+j+"</span>"):i+='<div class="listing__installment" x-ms-format-detection="none">'+m+"</div>",i+='<div class="listing__price  listing__price--hot-deal  delta  weight--semibold">',R&&(i+='<span class="listing__discount  micro  inline--block  line--inherit  soft-quarter--sides  valign--top">-'+y+"%</span>"),i+=" "+p+"</div>",i+="</div>"),i+="</div>"):(g&&1<C&&(i+='<div class="listing__installment" x-ms-format-detection="none">'+m+"</div>"),i+='<div class="listing__price  delta  weight--bold" x-ms-format-detection="none">'+p+"</div>"),i+="</div>",i+="</div>",i+="</article>",i+='<i class="basket__remove  icon  icon--wrong-circle  icon--flexible  text--light  absolute  top--right  js-remove-from-compare-basket" data-id="'+e+'"></i>',i+="</div>";var _,v,w,b,T,j,y,R;C="";h?(C='<div class="c-basket__item  o-list__item  u-flex  u-flex--items-start  is--hotdeal  basket__listing--'+e+'  visuallyhidden">',C+='<a href="#" class="c-basket__thumb  o-embed  o-embed--sm  u-margin-right-sm">',C+=f,C+='<img src="'+c+'">',C+="</a>",C+="<div>",C+='<a href="'+d+'" class="c-item__title  u-text-6  u-text-clamp">'+u+"</a>","true"==l.attr("data-hide-price")?(_=parseInt(l.attr("data-hide-price-hours"),10),v=parseInt(l.attr("data-hide-price-days"),10),w=l.attr("data-hide-price-hours-title"),b=l.attr("data-hide-price-days-title"),C+='<div class="c-basket__hotdeal-word">',C+='<span class="u-text-7  u-color-muted">'+l.attr("data-hide-price-title")+"</span>",C+="</div>",C+='<div class="c-item__price  u-text-6  u-text-bold  u-color-dark">',0<v&&(C+=v+" "+b),0<_&&(C+=" "+_+" "+w),C+="</div>",C+="</div>",C+='<a href="#" class="c-basket__remove  u-padding-sides-xs  u-padding-sides-md@mobile  u-text-unstyled  u-margin-left-auto">',C+='<span class="icon  icon--16  icon--muted  icon--close  js-remove-from-compare-basket" data-id="'+e+'"></span>',C+="</a>"):(T=l.attr("data-hot-deal-actual-price"),j=l.attr("data-hot-deal-actual-price-title"),(R=0<(y=parseFloat(l.attr("data-hot-deal-discount")))&&0!=T)?(C+='<div class="c-basket__hotdeal-word">',C+='<span class="u-text-7  u-text-strike">'+T+"</span>",C+='<span class="u-color-muted  u-text-8">'+j+"</span>",C+="</div>"):C+='<div class="c-item__installment  u-text-7  u-color-muted">'+m+"</div>",C+='<div class="c-item__price  u-text-6  u-text-bold  u-color-dark">',R&&(C+='<span class="c-item__price__discount">-'+y+"%</span>"),C+=" "+p+"</div>",C+="</div>",C+='<a href="#" class="c-basket__remove  u-padding-sides-xs  u-padding-sides-md@mobile  u-text-unstyled  u-margin-left-auto">',C+='<span class="icon  icon--16  icon--muted  icon--close  js-remove-from-compare-basket" data-id="'+e+'"></span>',C+="</a>",C+="</div>")):(C='<div class="c-basket__item  o-list__item  u-flex  u-flex--items-start  basket__listing--'+e+'  visuallyhidden">',C+='<a href="#" class="c-basket__thumb  o-embed  o-embed--sm  u-margin-right-sm">',C+=f,C+='<img src="'+c+'">',C+="</a>",C+="<div>",C+='<a href="'+d+'" class="c-item__title  u-text-6  u-text-clamp">'+u+"</a>",C+='<div class="c-item__installment  u-text-7  u-color-muted">'+m+"</div>",C+='<div class="c-item__price  u-text-6  u-text-bold  u-color-dark">'+p+"</div>",C+="</div>",C+='<a href="#" class="c-basket__remove  u-padding-sides-xs  u-padding-sides-md@mobile  u-text-unstyled  u-margin-left-auto">',C+='<span class="icon  icon--16  icon--muted  icon--close  js-remove-from-compare-basket" data-id="'+e+'"></span>',C+="</a>",C+="</div>"),$(".js-compare-basket__listings-container").append(i),$(".js-compare-basket__listings-container").append(C),n==t&&(o(),$("#compare_listings").removeClass("visuallyhidden"),$.fn.collapse&&a.collapse("show"),$("#compare_listings .js-compare-notification").removeClass("visuallyhidden u-hide"),a.find("img").unveil())}(n),l.prop("checked",!0).attr("checked","checked"),e.addClass(" is--active")):(d(n),l.prop("checked",!1).removeAttr("checked"),e.removeClass("is--active"))}))},window.iCarFunctions.compare(),$(".js-compare-basket__listings-container").on("click",".js-remove-from-compare-basket",(function(e){e.preventDefault();var a=$('.js-toggle-compare-basket[name="compare'+$(this).attr("data-id")+'"]');return 0<a.length&&(a.removeAttr("checked"),e=a.parent(),"LABEL"===a.parent().get(0).tagName&&e.removeClass("is--active")),d($(this).attr("data-id")),!1})),$(".js-remove-compare").on("click",(function(e){e.preventDefault(),l($(this).attr("data-listing-id")),location.reload()}))})),$(document).ready((function(){var e=$(".js-compact-page").val();$(".js-compact-page").on("change",(function(a){a.preventDefault(),(a=$(this).val())&&a!=e&&t("page_number",e,a)}));var a=$(".js-listing-page").val();$(".js-listing-page").on("change",(function(e){e.preventDefault(),(e=$(this).val())&&e!=a&&t("page_size",a,e)})),window.iCarFunctions.sortBy=function(e){var a=$(".js-listing-sort").val();$(".js-listing-sort"+e).on("change",(function(e){e.preventDefault(),t("sort",a,$(this).val())}))},window.iCarFunctions.sortBy("");var t=function(e,a,t){var i=$(location).attr("protocol")+"//"+$(location).attr("host"),n=$(location).attr("search"),r=$(location).attr("pathname");a=0<a.length?a:"best.match",t=0<t.length?e+"="+t:"",0<n.length?(0<=n.indexOf(a=e+"="+a)?n=n.replace(a,t):n+=0<t.length?"&"+t:"","&"==n.slice(-1)&&(n=n.slice(0,-1))):n=0<t.length?"?"+t:"",void 0===$.pjax?$(location).attr("href",i+r+n):$.pjax({url:i+r+n,container:"#classified-listings-result",push:!0,replace:!1,timeout:3e4,scrollTo:!1})}})),$(document).ready((function(){$("body").on("click",".js-save-car",(function(e){e.preventDefault();var a=$(this);if(a.hasClass("disabled"))return!1;var t=a.hasClass("action-items__item--save-active")||a.hasClass("is--active")?"remove":"save",i=a.attr("data-id"),n=(e=a.attr("data-car-id"),$(".action-items__item--"+i));return n.addClass("disabled"),$.ajax({url:"/ajax/save",type:"GET",contentType:"application/json; charset=utf-8",dataType:"json",data:{id:"save"==t?i:e,action:t},success:function(e,i,r){n.removeClass("disabled");try{"save"==t?(n.attr("data-car-id",e.CreateSavedCarResult),$("span.save-title",n).html(a.attr("data-saved")),a.attr("data-tooltip",a.attr("data-saved"))):($("span.save-title",n).html(a.attr("data-save")),a.attr("data-tooltip",a.attr("data-save")))}catch(e){}},error:function(e,a,t){var i;400==e.status&&e.responseJSON&&e.responseJSON.message&&((i=$(".js-modal-error-saved-cars")).find(".js-modal-error-message").html(e.responseJSON.message),i.removeClass("visuallyhidden"),window.iCarWidgets.popup.current=i.bPopup({modalClose:!0,positionStyle:"fixed",onOpen:function(){$("html, body, main").addClass("no--overflow"),window.iCarWidgets.popup.onOpen($(this).attr("class"))},onClose:function(){$("html, body, main").removeClass("no--overflow"),window.iCarWidgets.popup.onClose()}})),n.removeClass("disabled"),n.toggleClass("action-items__item--save-active"),n.toggleClass("is--active")}}),n.toggleClass("action-items__item--save-active"),n.toggleClass("is--active"),!1}))})),$(document).ready((function(){window.iCarFunctions.showCtr=function(){$(".js-ctr-button").each((function(){var e=$(this).attr("data-listing-id"),a=$(this).attr("data-seller-username");$.cookie("car-index-lead-"+window.iCarWidgets.slugify(window.iCarFunctions.decrypt(a))+"-"+e)&&$(this).removeClass("js-ctr-button")}))},window.iCarFunctions.showCtr(),$("body").on("click",".js-ctr-button",(function(e){e.preventDefault();var a,t=$(this),i=window.iCarFunctions.pixelRegistration;"function"!=typeof i||t.hasClass("js-ctr-button")&&(t.removeClass("js-ctr-button"),a="new"==t.attr("data-ad-type").toLowerCase()?"n":"u",e=window.iCarFunctions.decrypt(t.attr("data-seller-username")),i(t.attr("data-listing-id"),a,e))}))})),$(document).ready((function(){var e,a,t,i,n,r,s,o,l,d,c,u,p,C,m,h,g,f;$(".no-result").parent().addClass("no-result__height"),void 0===$.cookie("popup_ads")&&$(".modal--ads").bPopup({onOpen:function(){$(".modal--ads").removeClass("visuallyhidden")},onClose:function(){$(".modal--ads").addClass("visuallyhidden"),$.cookie("popup_ads","true")}}),window.iCarAjaxCall={elastic:function(){var e;window.tracking&&($.ajax({url:"/ajax/elastic",type:"GET",data:window.tracking.params}),(e=window.tracking.params).t="elastic",tmlPush(e))}},window.iCarAjaxCall.elastic(),$(".gallery__image").length&&($(window).on("resize load",(function(e){var a=$(".gallery__image .gallery__item").innerHeight(),t=$(".gallery__video:not(.cycle-sentinel)");$(window).width()<1080?t.css({height:a+"px"}):t.css({position:"absolute",top:"0",left:"0","z-index":100,opacity:1,display:"block",visibility:"visible"})})),$(".vjs-tech").on("contextmenu",(function(e){e.preventDefault()}))),$(".c-unfold label[for]").length&&(e=$(".c-unfold label[for]"),a=e.siblings(".c-unfold__content"),t=parseInt(a.css("line-height")),_=function(){var i=a.removeClass("c-unfold__content").height();a.addClass("c-unfold__content"),3<i/t?e.removeClass("u-hide"):e.addClass("u-hide")},ssm.addStates([{id:"desktop",query:window.iCarAsiaParameters.mediaQueryDesktop,onEnter:_},{id:"tabletMobile",query:window.iCarAsiaParameters.mediaQueryPortable,onResize:_}])),setTimeout((function(){var e=$(".js-ad-unit-above").height();90<=e&&($(".js-ad-unit-above").removeClass("js-ad-unit-height-90"),$(".js-ad-unit-above").addClass("js-ad-unit-height-"+e))}),15e3),o=$(".classified-search"),l=$(".js-price-check"),d=$(".js-price-check__input-brand"),c=$(".js-price-check__input-model"),u=$(".js-price-check__input-year"),p="price-check--show-result",C=l.find('button[type="submit"]'),l.length&&d.length&&c.length&&u.length&&(s=function(){C.attr("disabled","disabled"),""!=d.val()&&""!=c.val()&&""!=u.val()&&C.removeAttr("disabled")},d.selectize({lockOptgroupOrder:!0,onChange:function(e){c.length&&(n.disable(),n.clearOptions(),u.length&&(r.disable(),r.clearOptions(),n.load((function(e){i&&i.abort(),i=$.ajax({url:"/ajax/facets",data:window.iCarWidgets.formData(l),success:function(e){n.enable();var a=e.models;(e=e.models_groups)?$.each(e,(function(e,a){e&&n.addOption({value:e,name:e,class:"weight--semibold",group:e}),$.each(a,(function(a,t){a&&n.addOption({value:a,name:a,class:"soft--left",group:e})}))})):$.each(a,(function(e,a){""!=e&&n.addOption({value:e,name:e,class:"",group:""})}))},error:function(){e()}})})),s()))}}),c.selectize({readOnly:!0,valueField:"value",labelField:"name",searchField:["name"],render:{option:function(e,a){return'<div data-value="'+e.value+'" data-selectable class="option  '+e.class+'">'+a(e.name)+"</div>"}},onChange:function(e){u.length&&(r.disable(),r.clearOptions(),l.find('[name="model"]').val(e),l.find('[name="model_group"]').val(""),c[0].selectize.options[e]&&c[0].selectize.options[e].group&&c[0].selectize.options[e].group&&(l.find('[name="model_group"]').val(c[0].selectize.options[e].group),c[0].selectize.options[e].group==e)?l.find('[name="model"]').val(""):(r.load((function(e){i&&i.abort(),i=$.ajax({url:"/ajax/facets",data:window.iCarWidgets.formData(l),success:function(e){r.enable(),e=e.years,$.each(e,(function(e,a){""!=e&&r.addOption({value:e,name:e,class:"",group:""})}))},error:function(){e()}})})),s()))}}),n=c[0].selectize,u.selectize({readOnly:!0,valueField:"value",labelField:"name",searchField:["name"],render:{option:function(e,a){return'<div data-value="'+e.value+'" data-selectable class="option  '+e.class+'">'+a(e.name)+"</div>"}},onChange:function(){s()}}),r=u[0].selectize,l.on("submit",(function(e){e.preventDefault(),e=window.iCarWidgets.formData(l),e=$.ajax({url:"/ajax/pricecheck",data:e}),o.removeClass(p),e.success((function(e){o.addClass(p),$(".js-price-check__output").html($(e).find(".js-price-check__output").html()),$(".js-price-check__result--close").on("click",(function(){o.removeClass(p)}))}))})));var _,v,w=$(".js-classified-form"),b="car"==w.find('[name="vehicle_type"]').val()?"car":"mcycle",T={make:{class:"select.js-classified-search__input--make",function:"generateOptions",get_inputs:"select.js-classified-search__input--model",key:"models",onChangeClear:["model","nickname","variant"],selectize_settings:{lockOptgroupOrder:!0,render:{optgroup_header:function(e,a){return'<div class="optgroup-header  weight--semibold">'+a(e.label)+"</div>"},option:function(e,a){return'<div data-value="'+a(e.value)+'" data-selectable class="option  option--brand"><span class="selectize-brand__option__icon  float--right  brand-small  brand-small--'+a(e.value).toLowerCase().replace(" ","-")+"  brand-small--"+b+'"></span><span class="selectize-brand__option__label  brand-label  brand-label--small  text--truncate">'+a(e.text)+"</span></div>"},item:function(e,a){return'<div data-value="'+a(e.value)+'" class="item  item--brand"><span class="selectize-brand__option__icon  float--right  brand-small  brand-small--'+a(e.value).toLowerCase().replace(" ","-")+"  brand-small--"+b+'"></span><span class="selectize-brand__option__label  brand-label  brand-label--small  text--truncate">'+a(e.text)+"</span></div>"}}}},model:{class:"select.js-classified-search__input--model",function:"generateOptions",get_inputs:"select.js-classified-search__input--variant",key:"variant",onChangeClear:["nickname","variant"],selectize_settings:{valueField:"value",labelField:"text",searchField:["text"],render:{option:function(e,a){return'<div data-value="'+e.value+'"  data-group="'+e.group+'" data-selectable class="option js-model-option '+e.class+'">'+e.text+"</div>"}}},conditional:{ifInputExist:{get_inputs:"select.js-classified-search__input--nickname",key:"nickname_label"}}},nickname:{class:"select.js-classified-search__input--nickname",function:"generateOptions",get_inputs:"select.js-classified-search__input--variant",key:"variant",onChangeClear:["variant"],selectize_settings:{valueField:"value",labelField:"text",searchField:["text"],render:{option:function(e,a){return'<div data-value="'+e.value+'"  data-group="'+e.group+'" data-selectable class="option js-model-option '+e.class+'">'+e.text+"</div>"}}}},type:{class:"input.js-classified-search__input-checkbox--type",function:"syncValue",selectize_settings:!1},variant:{class:"select.js-classified-search__input--variant",function:"syncValue"},stateAreas:{class:"select.js-classified-search__input--state-areas",function:"stateAreasGenerateOptions"},state:{class:"select.js-classified-search__input--state",function:"generateOptions",get_inputs:"select.js-classified-search__input--area",key:"area",onChangeClear:["area","city"]},area:{class:"select.js-classified-search__input--area",function:"generateOptions",get_inputs:"select.js-classified-search__input--city",key:"city",onChangeClear:["city"]},city:{class:"select.js-classified-search__input--city",function:"syncValue"}};window.iCarAsiaParameters.classifiedSearchParams={keyword:null,make:null,model:null,model_group:null,nickname_label:null,variant:null,greater_area:null,state:null,city:null,area:null,hotdeal:null,vehicle_type:null,type:null,profile_type:null,body_type:null,color:null,transmission:null,min_price:null,max_price:null,min_year:null,max_year:null,min_mileage:null,max_mileage:null},h=function(e){var a,t;void 0!==e.this&&(void 0===e.get_similar_inputs||(t=(a=e.this).attr("name")).length&&void 0!==window.iCarAsiaParameters.classifiedSearchParams[t]&&(e=$(e.get_similar_inputs).not(a[0]),window.iCarAsiaParameters.classifiedSearchParams[t]!=a.val()&&(window.iCarAsiaParameters.classifiedSearchParams[t]=a.val(),e.each((function(){"radio"!=$(this).attr("type")?$(this)[0].selectize.setValue(a.val()):a[0].checked&&$(this).val()===a.val()&&$(this).prop("checked",!0)})))))},f=function(e){var a,t,i,n,r;window.stateAreasGenerateOptions||(window.stateAreasGenerateOptions=!0,void 0!==e.this&&void 0!==e.class&&(n=(a=e.this)[0].selectize,t=$(".js-classified-form"),void 0!==(i=n.options[a.val()]).state&&($(e.class).not(a[0]).each((function(){$(this)[0].selectize.setValue(a.val())})),window.stateAreasGenerateOptions=!1,n=$('[name="state"][type="hidden"]',t),e=$('[name="area"][type="hidden"]',t),n.length&&e.length&&(n.each((function(){$(this).val(i.state)})),e.each((function(){$(this).val(a.val())})),e=$('[name="state"]',t),r=$('[name="area"]',t),e.length&&r.length&&(e.each((function(){var e=$(this);e[0].selectize&&e[0].selectize.setValue(i.state)})),$.ajax({url:"/ajax/facets",data:window.iCarWidgets.formData(t)}).success((function(e){r.each((function(){var t,i=$(this),n=i.parent();i[0].selectize&&((t=i[0].selectize)&&t.clearOptions(),!t||void 0!==e.area&&Object.keys(e.area).length?(n.has("visuallyhidden")&&n.removeClass("visuallyhidden"),$.each(e.area,(function(e,a){e&&t.addOption({value:e.toLowerCase(),text:e+" ("+a+")",class:"",group:""})})),t.enable(),t.setValue(window.iCarWidgets.slugify(a.val()))):t.disable())}))})))))))},m=function(e){var a,t,i,n,r;void 0!==e.this&&"object"==typeof e.get_inputs&&Object.keys(e.get_inputs)&&void 0!==e.get_similar_inputs&&(r=(a=e.this)[0].selectize,t=a.closest("form"),(i=a.attr("name")).length&&void 0!==window.iCarAsiaParameters.classifiedSearchParams[i]&&(n=$(e.get_similar_inputs).not(this),window.iCarAsiaParameters.classifiedSearchParams[i]!=a.val()&&(window.iCarAsiaParameters.classifiedSearchParams[i]=a.val(),n.each((function(){$(this)[0].selectize.setValue(a.val())})),r=r.options[a.val()],$('[name="model_group"]').length&&("make"!=i&&"model"!=i||$('[name="model_group"]').val(""),void 0!==r&&r.group&&$('[name="model_group"]').val(r.group)),e.beforeAjax&&e.beforeAjax(),$.ajax({url:"/ajax/facets",data:window.iCarWidgets.formData(t)}).success((function(a){for(get_inputs_key in e.get_inputs)$getInputs=$(e.get_inputs[get_inputs_key]),$getInputs.each((function(){var e,t,i=$(this),n=i.parent(),r=i[0].selectize,s=i.toArray(),o=getAttribute(i,"data-selected",""),l="true"==getAttribute(i,"data-show-modal-group-only",!1);if("models"===get_inputs_key&&a.models_groups&&Object.keys(a.models_groups).length&&(get_inputs_key="models_groups"),void 0!==a[get_inputs_key]&&void 0!==a[get_inputs_key][""]&&delete a[get_inputs_key][""],s&&s.length){for(var d in s)s[d].selectize.clearOptions();if(void 0===a[get_inputs_key]||!Object.keys(a[get_inputs_key]).length)return r.disable(),void("nickname_label"===get_inputs_key&&void 0===a.nickname_label&&void 0!==a.variant&&a.variant&&(e=$("select.js-classified-search__input--variant"),$.each(a.variant,(function(a,t){a&&e&&e.length&&$.each(e,(function(){$(this)[0].selectize.addOption({value:a.toLowerCase(),text:a+" ("+t+")",class:"",group:""})}))})),$.each(e,(function(){$(this)[0].selectize.enable()}))))}n.has("visuallyhidden")&&n.removeClass("visuallyhidden"),"models_groups"===get_inputs_key?(n=a[get_inputs_key],$.each(n,(function(e,a){e&&r.addOption({value:e.toLowerCase(),text:e,class:l?"":"weight--semibold",group:e}),l||$.each(a,(function(a,t){a&&r.addOption({value:a.toLowerCase(),text:a,class:"soft--left",group:e})}))}))):$.each(a[get_inputs_key],(function(e,t){var i=e.toLowerCase();(e=a.labels&&a.labels[get_inputs_key]&&a.labels[get_inputs_key][e]?a.labels[get_inputs_key][e]:e)&&s&&s.length&&$.each(s,(function(){$(this)[0].selectize.addOption({value:i,text:e+" ("+t+")",class:"",group:""})}))})),s&&s.length&&$.each(s,(function(){$(this)[0].selectize.enable()})),o&&(t=window.iCarWidgets.slugify(o),$.each(r.options,(function(e,a){var i=window.iCarWidgets.slugify(e);if(t==i&&s&&s.length)for(var n in s)s[n].selectize.setValue(e)})))}))})))))},g=function(e){$.each(e,(function(e,a){if(void 0!==T[a].class&&$(T[a].class).length){var t,i=$(T[a].class).toArray();for(t in i){var n=i[t].selectize;n&&(n.disable(),n.clearOptions())}}}))},$.each(T,(function(e,a){var t,i,n;void 0===a.selectize_settings&&(t=$(a.class).selectize()),void 0!==a.selectize_settings&&!1!==a.selectize_settings&&(t=$(a.class).selectize(a.selectize_settings)),(!1===a.selectize_settings||t&&t.length)&&("generateOptions"==a.function&&((i={})[a.key]=a.get_inputs,a.conditional&&a.conditional.ifInputExist&&$(a.conditional.ifInputExist.get_inputs).length&&(i[a.conditional.ifInputExist.key]=a.conditional.ifInputExist.get_inputs),$(a.class).on("change",(function(){var e;""!==$(this).val()?m({this:$(this),get_inputs:i,get_similar_inputs:a.class,beforeAjax:function(){a.onChangeClear&&g(a.onChangeClear)}}):i||a.onChangeClear&&g(a.onChangeClear),$(this).val()||(e=$(this).attr("name"))&&void 0!==window.iCarAsiaParameters.classifiedSearchParams[e]&&(window.iCarAsiaParameters.classifiedSearchParams[e]="")})),$(a.class).each((function(){this.selectize.$control_input.on("blur",(function(){var e=$(a.class).attr("name");e&&void 0!==window.iCarAsiaParameters.classifiedSearchParams[e]&&(window.iCarAsiaParameters.classifiedSearchParams[e]||a.onChangeClear&&g(a.onChangeClear))}))}))),"stateAreasGenerateOptions"===a.function&&$(a.class).on("change",(function(){f({this:$(this),class:a.class})})),n=getAttribute($(a.class),"data-selected",""),t&&!t[0].selectize.isLocked&&n&&t[0].selectize.setValue(n),"syncValue"==a.function&&$(a.class).on("change",(function(){h({this:$(this),get_similar_inputs:a.class})})))})),$(".js-body-type").length&&(_=getAttribute($(".js-body-type"),"data-selected",""),$(".js-body-type").selectize({render:{option:function(e,a){return"<div>"+a(e.text)+'<span class="float--right icon--car-'+a(e.value.replace(" ","-")).toLowerCase()+'"></span></div>'}}})[0].selectize.setValue(_)),$(".js-set-type").on("click",(function(e){return e.preventDefault(),$(this).siblings().removeClass("btn--selected"),$(this).siblings().addClass("btn--unselected"),$(this).removeClass("btn--unselected"),$(this).addClass("btn--selected"),!1})),w.length&&(y=w.find("select.selectized:not(.js-classified-form__button-reset)"),v=$(".js-search-button"),y.each((function(){this.selectize.on("focus",(function(){v.is(":visible")&&v.fadeOut()})),this.selectize.on("dropdown_open",(function(){v.is(":visible")&&v.fadeOut()})),this.selectize.on("type",(function(){v.is(":visible")&&v.fadeOut()})),this.selectize.on("blur",(function(){v.is(":visible")||v.fadeIn()})),this.selectize.on("dropdown_close",(function(){v.is(":visible")||v.fadeIn()}))})),w.on("submit",(function(e){e.preventDefault();var a=$(this),t=a.find('[name="min_price"]');e=a.find('[name="max_price"]');void 0!==window.iCarControls.JRanger.price&&void 0!==window.iCarControls.JRanger.price._data&&(n=window.iCarControls.JRanger.price._data,""!=t.val()&&void 0!==n[t.val()]&&t.val(n[t.val()]),""!=e.val()&&void 0!==n[e.val()]&&e.val(n[e.val()])),rangeWidget("[data-jranger]",a);var i,n=a.attr("data-suggest");return keywordParams={},null!=n&&""!=selectedSuggestion[n]&&(keywordParam=selectedSuggestion[n],$.each(keywordParam.split("&"),(function(e,a){item=a.split("="),keywordParams[item[0]]=decodeURIComponent(item[1].replace(/\+/g," "))})),$("[name=keyword]",a).val("")),void 0!==(e=window.iCarWidgets.formData(a)).min_price&&e.min_price&&void 0!==e.max_price&&e.max_price&&(n=rangeCalc(e.min_price,e.max_price),e.min_price=n.min,e.max_price=n.max),void 0!==e.min_mileage&&e.min_mileage&&void 0!==e.max_mileage&&e.max_mileage&&(i=rangeCalc(e.min_mileage,e.max_mileage),e.min_mileage=i.min,e.max_mileage=i.max),void 0!==e.min_year&&e.min_year&&void 0!==e.max_year&&e.max_year&&(i=rangeCalc(e.min_year,e.max_year),e.min_year=i.min,e.max_year=i.max),void 0!==e.model&&void 0!==e.model_group&&e.model.toLowerCase()==e.model_group.toLowerCase()&&(e.model=""),$(document).one("keydown",(function(e){27==e.keyCode&&(console.log("pressed",$("button[type='submit']",a)),Form.toggleFormActionButton($("button[type='submit']",a),!0))})),$.ajax({url:"/ajax/url",type:"GET",data:Object.keys(keywordParams).length?$.extend(e,keywordParams):e,success:function(e){var a="";void 0!==window.searchPostfix&&(a=window.searchPostfix,a=(!1===e.indexOf("?")?"?":"&")+a),window.location.href=e+a},error:function(e){return null}}),!0})),w.find(":input").prop("disabled",!1),$.fn.plugin_restore_on_type=function(){return this.each((function(){var e,a;this.selectize&&(e=this.selectize,a=e.onKeyDown,e.onKeyDown=function(t){var i;return/^[^\x00-\x1F\x80-\x9F]+$/.test(String.fromCharCode(t.keyCode))&&""===this.$control_input.val()&&!this.$activeItems.length&&0<=(i=this.caretPos-1)&&i<this.items.length?(i=this.options[this.items[i]],this.deleteSelection(t)&&(i.title=String.fromCharCode(t.keyCode),this.setTextboxValue(i.title),this.refreshOptions(!0)),void t.preventDefault()):a.apply(e,arguments)}.bind(e))}))},$("select.js-reset-selectize").plugin_restore_on_type());var j,y=$(".search-slideshow");y.length&&y.on("cycle-before",(function(e,a,t,i,n){$advanceSearch=$(t).find(".container--advanced-search"),$advanceSearch.length&&-1==$advanceSearch.attr("class").indexOf("rnr")&&-1==$advanceSearch.attr("class").indexOf("visuallyhidden")&&($toggler=$(t).find(".js-toggler"),$toggler.length&&$toggler.click())})),$(".js-classified-form__button-reset").on("click",(function(e){e.preventDefault(),w.find("input, select").each((function(){var e=$(this);e.hasClass("js-reset-selectize")&&(e.removeAttr("data-selected"),e.selectize()[0].selectize.setValue(""))}))})),w.find("input, select").each((function(){var e=$(this);e.on("focus",(function(){e.is('[class*="range-controls"]')||$(".range-controls").hide()}))})),$(".price-jranger").length&&(j=w.find('[name="min_price"], [name="max_price"]'),w.find('[name="min_price"]').on("typeahead:selected",(function(e,a,t){var i=$(this).closest("form").find('[name="max_price"]').val();$(".price-jranger .range-text").addClass("range-text--active").html(a+" - "+i),j.each((function(){var e=$(this);"max_price"==e.attr("name")&&e.val(i),"min_price"==e.attr("name")&&e.val(a)}))})),w.find('[name="max_price"]').on("typeahead:selected",(function(e,a,t){var i=$(this).closest("form").find('[name="min_price"]').val();$(".price-jranger .range-text").addClass("range-text--active").html(i+" - "+a),j.each((function(){var e=$(this);"max_price"==e.attr("name")&&e.val(a),"min_price"==e.attr("name")&&e.val(i)}))}))),window.iCarFunctions.dealerInfoDetails=function(){0<$(".dealerSlider").length&&$(".cycle-slideshow").cycle()},window.iCarFunctions.dealerInfoDetails()}));var iCarCTRDefaults={attributes:{},profileData:{id:"",name:"",phone:"",email:"",username:""},modal:".js-modal-dealer:first",jsNCFModalBody:".js-ncf-modal-body",jsNCFModalBodyDefault:".js-ncf-modal-body--default",jsNCFModalBodyTest:".js-ncf-modal-body--test",hideClass:"visuallyhidden u-hide",jsDealerPhone:".js-dealer-phone",jsDealerLineCheck:".js-dealer-line-check",jsDealerLineNumber:".js-dealer-line-number",jsNewDealerLineNumber:".js-dealer-line-number2",jsLineBusinessContainer:".js-dealer-line-number .contact--line_ad",jsNewLineBusinessContainer:".js-dealer-line-number2 .contact--line_ad",jsLineNumberContainer:".js-dealer-line-number .contact__group",jsNewLineNumberContainer:".js-dealer-line-number2 .contact__group",jsLineMessageContainer:".js-dealer-line-number  .copy__message",jsNewLineMessageContainer:".js-dealer-line-number2  .copy__message",jsDealerQRCode:".js-qr-code",jsNCFLineButtonContainer:".js-ncf-line-button-container",jsContactPhoneContainer:".js-contact--phones .contact__group",jsNewContactPhoneContainer:".js-contact--phones2 .contact__group",jsNCFInputLineNumber:".js-ncf-input-line-number",jsNCFButtonSendMessageFlow:".js-ncf-button-send-message-flow",jsNCFOptionSendMessageFlow:".js-ncf-option-send-message-flow",jsUpdateProfile:".js-update-profile",jsDealerName:".js-dealer-name",jsContactDealer:".js-contact--dealer",lineApi:"http://line.me/ti/p/~",userInputLineNumber:"",cookieKeyInputLineNumber:"NCF_INPUT_LINE_NUMBER"};function clickTrack(e){switch(console.log("Click Track"),!0){case-1!=$(e).attr("class").indexOf("js-contact-seller--jump-phone"):console.log("Trigger Phone"),window.iCarCTRJumperName="phone",console.log("Track: Contact CTR Click",e),gaPush({event:"custom_track",eventCategory:"New CTR Flow",eventAction:"Contact CTR Click"});break;case-1!=$(e).attr("class").indexOf("js-contact-seller--jump-whatsapp"):console.log("Trigger Whatsapp"),window.iCarCTRJumperName="whatsapp",console.log("Track: WhatsApp CTR Click",e),gaPush({event:"custom_track",eventCategory:"New CTR Flow",eventAction:"WhatsApp CTR Click"});break;case-1!=$(e).attr("class").indexOf("js-contact-seller--jump-line"):console.log("Trigger Line"),window.iCarCTRJumperName="line",console.log("Track: LINE CTR Click",e),gaPush({event:"custom_track",eventCategory:"New CTR Flow",eventAction:"LINE CTR Click"})}}window.iCarCTR=JSON.parse(JSON.stringify(iCarCTRDefaults)),window.iCarCTRJumperName="phone",window.iCarCTRMethod={isCTRTestActive:!1,modal:{},jsNCFModalBody:{},jsNCFModalBodyDefault:{},jsNCFModalBodyTest:{},jsDealerPhone:{},jsDealerLineCheck:{},jsDealerLineNumber:{},jsNewDealerLineNumber:{},jsLineNumberContainer:{},jsNewLineNumberContainer:{},jsLineBusinessContainer:{},jsNewLineBusinessContainer:{},jsLineMessageContainer:{},jsNewLineMessageContainer:{},jsDealerQRCode:{},jsNCFLineButtonContainer:{},jsContactPhoneContainer:{},jsNewContactPhoneContainer:{},jsNCFInputLineNumber:{},jsNCFButtonSendMessageFlow:{},jsNCFOptionSendMessageFlow:{},jsUpdateProfile:{},jsDealerName:{},jsContactDealer:{}},window.iCarCTRAnalytic={},iCarCTRAnalytic.dataLayerEcommerceClick=function(){if("undefined"==typeof dataLayer)return!1;var e={event:"ecommerce_click",ecommerce:{click:{actionField:{list:iCarCTRMethod.getModalContextUrl()},products:[{name:iCarCTRMethod.getListingTitle(),id:iCarCTRMethod.getListingId(),price:iCarCTRMethod.getPrice(),category:iCarCTRMethod.getAdType(),brand:iCarCTRMethod.getMakeModel(),variant:iCarCTRMethod.getVariant(),year:iCarCTRMethod.getYear()}]}}};return gaPush(e)},iCarCTRMethod.generateRandomId=function(){return Date.now()+Math.floor(900*Math.random()+100)},iCarCTRMethod.setModalPositionTop=function(){var e=$(".modal--dealer-ctr"),a=e.height();e.css({top:7140/a+"%"})},iCarCTRAnalytic.dataLayerEcommerceAdd=function(){var e={event:"ecommerce_add",ecommerce:{add:{products:[{name:iCarCTRMethod.getListingTitle(),id:iCarCTRMethod.getListingId(),price:iCarCTRMethod.getPrice(),category:iCarCTRMethod.getAdType(),brand:iCarCTRMethod.getMakeModel(),variant:iCarCTRMethod.getVariant(),year:iCarCTRMethod.getYear(),quantity:1}]}}};return gaPush(e)},iCarCTRAnalytic.dataLayerEcommerceCheckout=function(e,a){var t=a.split("_");return(a={event:a})[t[0]]={},a[t[0]][t[1]]={actionField:e,products:[{name:iCarCTRMethod.getListingTitle(),id:iCarCTRMethod.getListingId(),price:iCarCTRMethod.getPrice(),category:iCarCTRMethod.getAdType(),brand:iCarCTRMethod.getMakeModel(),variant:iCarCTRMethod.getVariant(),year:iCarCTRMethod.getYear(),quantity:1}]},gaPush(a)},iCarCTRAnalytic.postLeadMessage=function(e,a,t,i){if(t=$.isEmptyObject(t)?{name:iCarCTR.profileData.name,phone:iCarCTR.profileData.phone,email:iCarCTR.profileData.email,userId:iCarCTR.profileData.id,remarks:"",profileId:iCarCTRMethod.getProfileId(),sellerId:iCarCTRMethod.getSellerId(),listingId:iCarCTRMethod.getListingId(),location:iCarCTRMethod.getState(),terms:1,_csrf:iCarCTRMethod.getCsrfToken()}:t,!(t=$.isEmptyObject(i)?t:$.extend(t,i)).remarks)return new Error("Message is empty!"),!1;$.ajax({url:"/ajax/lead",data:t,dataType:"json",type:"POST",success:function(a,t,i){void 0!==e&&e(a,t,i),void 0!==window.googleGACode&&(ga("create",googleGACode,"auto"),ga("send",{hitType:"event",eventCategory:"New CTR Flow",eventAction:"Level 2 Message Lead Click"})),iCarCTRAnalytic.postLead("send_msg_count")},error:function(e,t,i){void 0!==a&&a(e,t,i)}})},iCarCTRAnalytic.postLeadDealer=function(e){gaPush({eventCode:"cad-msg",eventId:iCarCTRMethod.getListingId(),event:"Lookup"}),"function"==typeof iCarFunctions.pixelRegistration&&iCarFunctions.pixelRegistration(iCarCTRMethod.getListingId(),iCarCTRMethod.isListingTypeNew()?"n":"u",iCarCTRMethod.getSellerUsername())},iCarCTRAnalytic.postLead=function(e){var a={call_clicks:"call_clicks",call_count:"call_count",line_clicks:"line_clicks",line_count:"line_count",send_msg_clicks:"send_msg_clicks",send_msg_count:"send_msg_count",chat_clicks:"chat_clicks",chat_count:"chat_count",wa_clicks:"wa_clicks",wa_count:"wa_count",ctr_call_lvl_1:"call_clicks",ctr_call_lvl_2:"call_count",ctr_line_lvl_1:"line_clicks",ctr_line_lvl_2:"line_count",ctr_message_lvl_1:"send_msg_clicks",ctr_message_lvl_2:"send_msg_count",ctr_chat_lvl_1:"chat_clicks",ctr_chat_lvl_2:"chat_count",ctr_whatsapp_lvl_1:"wa_clicks",ctr_whatsapp_lvl_2:"wa_count"};return void 0!==a[e]&&"function"==typeof iCarFunctions.pixelRegistration&&(iCarFunctions.pixelRegistration(iCarCTRMethod.getListingId(),iCarCTRMethod.isListingTypeNew()?"n":"u",iCarCTRMethod.getSellerUsername(),a[e]),"chat_count"===a[e]&&void 0!==window.googleGACode&&(ga("create",googleGACode,"auto"),ga("send",{hitType:"event",eventCategory:"New CTR Flow",eventAction:"Level 2 Chat Lead Sent"}))),!1},iCarCTRMethod.isProfileComplete=function(){return!!(iCarCTR.profileData.name&&iCarCTR.profileData.email&&iCarCTR.profileData.phone)},iCarCTRMethod.getSellerUsername=function(){return iCarCTR.attributes.sellerUsername?iCarFunctions.decrypt(iCarCTR.attributes.sellerUsername):""},iCarCTRMethod.isListingTypeNew=function(){return"new"===(iCarCTRMethod.getAdType()?iCarCTRMethod.getAdType().toLowerCase():"")},iCarCTRMethod.CTRPhone=function(){iCarCTRMethod.jsDealerPhone.removeClass(iCarCTR.hideClass),iCarCTRMethod.updateViewPhoneNumbers(),iCarCTRMethod.setModalPositionTop()},iCarCTRMethod.CTRWhatsapp=function(){iCarCTRMethod.updateViewLineNumbers(),iCarCTRMethod.jsDealerLineNumber.removeClass(iCarCTR.hideClass),iCarCTRMethod.jsNewDealerLineNumber.removeClass(iCarCTR.hideClass)};var $dealerModal=iCarCTRMethod.modal=$(iCarCTR.modal);iCarCTRMethod.jsNCFModalBody=$(iCarCTRDefaults.jsNCFModalBody),iCarCTRMethod.jsNCFModalBodyDefault=$(iCarCTRDefaults.jsNCFModalBodyDefault),iCarCTRMethod.jsNCFModalBodyTest=$(iCarCTRDefaults.jsNCFModalBodyTest);var $jsDealerPhone=iCarCTRMethod.jsDealerPhone=$(iCarCTRDefaults.jsDealerPhone),$jsDealerLineCheck=iCarCTRMethod.jsDealerLineCheck=$(iCarCTRDefaults.jsDealerLineCheck),$jsDealerLineNumber=iCarCTRMethod.jsDealerLineNumber=$(iCarCTRDefaults.jsDealerLineNumber),$jsNewDealerLineNumber=iCarCTRMethod.jsNewDealerLineNumber=$(iCarCTRDefaults.jsNewDealerLineNumber),$jsDealerQRCode=iCarCTRMethod.jsDealerQRCode=$(iCarCTRDefaults.jsDealerQRCode);iCarCTRMethod.jsNCFLineButtonContainer=$(iCarCTRDefaults.jsNCFLineButtonContainer),iCarCTRMethod.jsContactPhoneContainer=$(iCarCTRDefaults.jsContactPhoneContainer),iCarCTRMethod.jsNewContactPhoneContainer=$(iCarCTRDefaults.jsNewContactPhoneContainer),iCarCTRMethod.jsLineNumberContainer=$(iCarCTRDefaults.jsLineNumberContainer),iCarCTRMethod.jsNewLineNumberContainer=$(iCarCTRDefaults.jsNewLineNumberContainer),iCarCTRMethod.jsLineBusinessContainer=$(iCarCTRDefaults.jsLineBusinessContainer),iCarCTRMethod.jsNewLineBusinessContainer=$(iCarCTRDefaults.jsNewLineBusinessContainer),iCarCTRMethod.jsLineMessageContainer=$(iCarCTRDefaults.jsLineMessageContainer),iCarCTRMethod.jsNewLineMessageContainer=$(iCarCTRDefaults.jsNewLineMessageContainer),iCarCTRMethod.jsNCFInputLineNumber=$(iCarCTRDefaults.jsNCFInputLineNumber),iCarCTRMethod.jsNCFButtonSendMessageFlow=$(iCarCTRDefaults.jsNCFButtonSendMessageFlow),iCarCTRMethod.jsNCFOptionSendMessageFlow=$(iCarCTRDefaults.jsNCFOptionSendMessageFlow),iCarCTRMethod.jsUpdateProfile=$(iCarCTRDefaults.jsUpdateProfile),iCarCTRMethod.jsDealerName=$(iCarCTRDefaults.jsDealerName),iCarCTRMethod.jsContactDealer=$(iCarCTRDefaults.jsContactDealer),iCarCTRMethod.isLogin=function(e,a){var t=!$(".js-loginbtn").length;return t&&"function"==typeof e&&e(),t||"function"!=typeof a||a(),t},iCarCTRMethod.getCsrfToken=function(){return $('meta[name="csrf-token"]').attr("content")||$('input[name="_csrf"]').attr("value")},iCarCTRMethod.profileDataCheck=function(e,a){$.ajax({url:"/ajax/profiledatacheck",type:"POST",dataType:"json",headers:{"X-CSRF-TOKEN":iCarCTRMethod.getCsrfToken()},success:function(a,t,i){"function"==typeof e&&e(a,t,i)},error:function(e,t,i){"function"==typeof a&&a(e,t,i)}})},iCarCTRMethod.updateProfileData=function(e){$.isEmptyObject(e)?iCarCTRMethod.profileDataCheck((function(e){iCarCTR.profileData=$.extend(iCarCTR.profileData,e)})):iCarCTR.profileData=$.extend(iCarCTR.profileData,e)},iCarCTRAnalytic.postLeadLine=function(e,a,t){var i=iCarCTRMethod.getWhatsappNumber(),n="/ajax/ctr-whatsapp";"lineUrl"==iCarCTR.attributes.newctrExchatDetection&&(i=iCarCTRMethod.getLineId(),n="/ajax/ctr-line"),i=void 0!==e?e:i,$.ajax({type:"POST",url:n,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{listing_id:iCarCTRMethod.getListingId(),from:iCarCTRMethod.getUserInputLineNumber(),to:i},success:function(e){"function"==typeof a&&a(e)},error:function(e){"function"==typeof t&&t(e)}})},iCarCTRMethod.getListingId=function(){return iCarCTR.attributes.listingId},iCarCTRMethod.toggleCTRDefault=function(){console.log("toggleCTRDefault jsContactDealer",iCarCTRMethod.jsContactDealer),iCarCTRMethod.jsContactDealer.remove()},iCarCTRMethod.toggleCTRTest=function(){console.log("toggleCTRTest jsContactDealer",iCarCTRMethod.jsContactDealer),iCarCTRMethod.jsContactDealer.removeClass("u-hide visuallyhidden"),iCarCTRMethod.jsDealerName.remove()},iCarCTRMethod.onCTRTestClose=function(){iCarCTR=JSON.parse(JSON.stringify(iCarCTRDefaults)),iCarCTRMethod.toggleLineMessage("close"),iCarCTRMethod.jsDealerPhone.addClass(iCarCTR.hideClass),iCarCTRMethod.jsDealerLineCheck.addClass(iCarCTR.hideClass),iCarCTRMethod.jsDealerLineNumber.addClass(iCarCTR.hideClass),iCarCTRMethod.jsNewDealerLineNumber.addClass(iCarCTR.hideClass),iCarCTRMethod.jsDealerQRCode.addClass(iCarCTR.hideClass),iCarCTRMethod.jsNCFOptionSendMessageFlow.addClass(iCarCTR.hideClass)},iCarCTRMethod.setUserInputLineNumber=function(e){return iCarCTRMethod.jsNCFInputLineNumber.val(e),$.cookie(iCarCTR.cookieKeyInputLineNumber,e,{path:"/"}),e},iCarCTRMethod.getUserInputLineNumber=function(){return $.cookie(iCarCTR.cookieKeyInputLineNumber)},iCarCTRMethod.applyUserInputLineNumber=function(){iCarCTRMethod.jsNCFInputLineNumber.val(iCarCTRMethod.getUserInputLineNumber())},iCarCTRMethod.getSellerName=function(){return iCarCTR.attributes.sellerName?iCarFunctions.decrypt(iCarCTR.attributes.sellerName):null},iCarCTRMethod.getLineId=function(){return iCarCTR.attributes.lineId?iCarFunctions.decrypt(iCarCTR.attributes.lineId):null},iCarCTRMethod.getWhatsappNumber=function(){return iCarCTR.attributes.phoneWhatsapp?iCarFunctions.decrypt(iCarCTR.attributes.phoneWhatsapp).replace(/[\- ]/g,""):null},iCarCTRMethod.getWhatsapp=function(){var e=[];return e.push(iCarCTR.attributes.phoneWhatsapp?iCarFunctions.decrypt(iCarCTR.attributes.phoneWhatsapp):null),e},iCarCTRMethod.getLineUrl=function(){return iCarCTR.attributes.lineId?iCarCTR.lineApi+iCarCTRMethod.getLineId():null},iCarCTRMethod.getPhoneNumbers=function(){var e,a=null,t={my:"6",id:"62",th:"66"}[iCarAsiaParameters.countryCode],i="//web.whatsapp.com/send?phone=";return/(iPhone|Android|webOS|BlackBerry|iPod)/.test(navigator.userAgent)&&(i="https://api.whatsapp.com/send?phone="),iCarCTR.attributes.phones&&iCarFunctions.decrypt(iCarCTR.attributes.phones)&&(a={},e=JSON.parse(iCarFunctions.decrypt(iCarCTR.attributes.phones)),$.each(e,(function(e,n){n.cleanNumber=n.number.replace(/[\- ]/g,"");var r=n.cleanNumber.replace(/[\+ ]/g,""),s=new RegExp("^("+t+")");n.phoneNumberOnly=r.replace(s,""),n.phoneNumberCountryNoPlus=t+n.phoneNumberOnly,n.whatsAppUrl="whats_app"===n.type&&"forwarding"!==n.type?i+n.phoneNumberCountryNoPlus+"&text="+iCarCTR.attributes.defaultWhatsappText:null,n.whatsApp_Url="forwarding"!==n.type?i+n.phoneNumberCountryNoPlus+"&text="+iCarCTR.attributes.defaultWhatsappText:null,n.formattedNumber=(iCarAsiaParameters.CTRModalPhoneRegex,n.number.toString().replace(iCarAsiaParameters.CTRModalPhoneRegex.find,iCarAsiaParameters.CTRModalPhoneRegex.replace)),s=iCarCTRMethod.getLineId(),n.lineId=void 0!==n.line_number&&""!==n.line_number?n.line_number:s||null,n.line_number=n.lineId,n.lineUrl=n.lineId?iCarCTR.lineApi+n.lineId:null,n.name=void 0!==n.name?n.name:"",a[n.cleanNumber]=n}))),a},iCarCTRMethod.getLineNumbers=function(){var e=[];return $.each(iCarCTRMethod.getPhoneNumbers(),(function(a,t){t[iCarCTR.attributes.newctrExchatDetection]&&e.push({phone:t.cleanNumber,url:t[iCarCTR.attributes.newctrExchatDetection],name:t.name||iCarCTRMethod.getSellerName(),type:iCarCTR.attributes.newctrExchatDetection})})),e},iCarCTRMethod.getWhatsApp=function(){var e=iCarCTRMethod.getPhoneNumbers();return $.each(e,(function(e,a){if("whats_app"===a.type)return a})),null},iCarCTRMethod.getWhatsAppUrl=function(){return iCarCTRMethod.getWhatsApp()?iCarCTRMethod.getWhatsApp().whatsAppUrl:null},iCarCTRMethod.renderViewPhoneNumbers=function(){var e='<div class="contact__item  flexbox  u-padding-ends-sm  u-margin-top-xs"><div class="flexbox__row  u-flex  u-flex--items-center"><div class="flexbox__item  one-whole  u-flex__fill "><a href="__LINK_TEL_PHONE_NUMBER__" data-ga-event="ctr_call_lvl_2" data-ga-click-type="cad-cal" data-ga-click-id="'+iCarCTR.attributes.listingId+'" class="number  weight--semibold  u-text-5  u-text-semibold  u-text-unstyled">__FORMATTED_PHONE_NUMBER__</a><div class="contact__meta  muted  milli"><span>__PHONE_NAME__</span></div></div><div class="flexbox__item"><a href="__LINK_TEL_PHONE_NUMBER__" data-ga-event="ctr_call_lvl_2"  data-ga-click-type="cad-cal" data-ga-click-id="'+iCarCTR.attributes.listingId+'" class="btn  btn--action c-btn c-btn--action btn--full  text--center"><span class="icon  icon--20  icon--call  flush u-margin-left-none u-margin-right-xs"></span> '+iCarCTR.attributes.newctrCallus+"</a></div></div></div>",a=[],t=iCarCTRMethod.getPhoneNumbers();return $.each(t,(function(t,i){"6280000000000"!==i.phoneNumberCountryNoPlus&&a.push(e.replace(/__PHONE_NAME__/g,i.name||"").replace(/__LINK_TEL_PHONE_NUMBER__/g,"tel:"+i.cleanNumber).replace(/__FORMATTED_PHONE_NUMBER__/g,i.formattedNumber))})),a.length?a.join(""):null},iCarCTRMethod.renderViewPhoneNumbers2=function(){var e='<div class="o-grid  contact__item"><div class="o-grid__item  u-flex  u-align-items-center"><div class="u-padding-md  u-padding-ends-sm@mobile  u-padding-sides-xxs@mobile"><a href="__LINK_TEL_PHONE_NUMBER__" data-ga-event="ctr_call_lvl_2" data-ga-click-type="cad-cal" data-ga-click-id="'+iCarCTR.attributes.listingId+'" class="contact__item-phones  u-text-semibold  u-text-5">__FORMATTED_PHONE_NUMBER__</a><span class="u-block  u-color-muted  u-text-7">__PHONE_NAME__</span></div><div class="o-grid__item  u-flex  u-align-items-center  u-justify-content-end"><div class="u-padding-md  u-padding-ends-sm@mobile  u-padding-sides-xxs@mobile"><a href="__LINK_TEL_PHONE_NUMBER__" data-ga-event="ctr_call_lvl_2"  data-ga-click-type="cad-cal" data-ga-click-id="'+iCarCTR.attributes.listingId+'" class="c-btn  c-btn--action  u-padding-xxs@mobile">'+iCarCTR.attributes.newctrCallus+"</a></div></div></div></div>",a=[],t=iCarCTRMethod.getPhoneNumbers();return $.each(t,(function(t,i){"6280000000000"!==i.phoneNumberCountryNoPlus&&a.push(e.replace(/__PHONE_NAME__/g,i.name||"").replace(/__LINK_TEL_PHONE_NUMBER__/g,"tel:"+i.cleanNumber).replace(/__FORMATTED_PHONE_NUMBER__/g,i.formattedNumber))})),a.length?a.join(""):null},iCarCTRMethod.updateViewPhoneNumbers=function(){iCarCTRMethod.jsContactPhoneContainer.html(iCarCTRMethod.renderViewPhoneNumbers()),iCarCTRMethod.jsNewContactPhoneContainer.html(iCarCTRMethod.renderViewPhoneNumbers2())},iCarCTRMethod.renderViewLineNumbers=function(){var e=[];return 0!==iCarCTRMethod.getLineNumbers().length?(iCarCTRMethod.jsLineNumberContainer.removeClass("u-hide  visuallyhidden"),$.each(iCarCTRMethod.getLineNumbers(),(function(a,t){"lineUrl"==t.type?e.push('<div class="contact__item contact__item--line  flexbox"><div class="flexbox__row u-flex  u-flex--items-center  u-padding-ends-xs"><div class="flexbox__item  one-whole  u-flex__fill"><a data-ga-event="ctr_line_lvl_2" target="_line" data-line-id="__LINE_ID__" href="__LINE_LINK__" class="line_name  weight--semibold js-qrcode-window  u-text-5  u-color-dark">__LINE_NAME__</a></div><div class="flexbox__item"><a target="_line" data-ga-event="ctr_line_lvl_2" data-line-id="__LINE_ID__" href="__LINE_LINK__" class="btn  btn--action js-qrcode-window  c-btn  c-btn--positive">__T_CHAT_NOW__</a></div></div></div>'.replace(/__LINE_NAME__/g,t.name).replace(/__LINE_LINK__/g,t.url).replace(/__LINE_ID__/g,t.phone).replace(/__T_CHAT_NOW__/g,iCarCTR.attributes.newctrChatNow)):e.push('<div class="contact__item contact__item--whatsapp  flexbox"><div class="flexbox__row u-flex  u-flex--items-center  u-padding-ends-xs"><div class="flexbox__item  one-whole  u-flex__fill"><a data-ga-event="ctr_whatsapp_lvl_2" target="_wa" data-whatsapp-number="__CHAT_ID__" href="__CHAT_LINK__" class="whatsapp_name  weight--semibold u-text-5  u-color-dark">__CHAT_ID_SHOW__</a></div><div class="flexbox__item"><a target="_wa" data-ga-event="ctr_whatsapp_lvl_2" data-whatsapp-number="__CHAT_ID__" href="__CHAT_LINK__" class="btn  btn--action c-btn  c-btn--positive">__T_CHAT_NOW__</a></div></div></div>'.replace(/__CHAT_NAME__/g,t.name).replace(/__CHAT_LINK__/g,t.url).replace(/__CHAT_ID_SHOW__/g,t.phone.replace(/^(([^0-9]*[0-9]){4,4})([^0-9]*)[0-9]([^0-9]*)[0-9]([^0-9]*)[0-9]([^0-9]*)[0-9]/,"$1$3*$4*$5*$6*")).replace(/__CHAT_ID__/g,t.phone).replace(/__T_CHAT_NOW__/g,iCarCTR.attributes.newctrChatNow))}))):iCarCTRMethod.jsLineNumberContainer.addClass("u-hide  visuallyhidden"),e.length?e.join(""):null},iCarCTRMethod.renderViewLineNumbers2=function(){var e=[];return $.each(iCarCTRMethod.getLineNumbers(),(function(a,t){"lineUrl"==t.type?e.push('<div class="o-grid  contact__item"><div class="o-grid__item  u-flex  u-align-items-center"><div class="u-padding-md  u-padding-ends-sm@mobile  u-padding-sides-xxs@mobile"><a data-ga-event="ctr_line_lvl_2" target="_line" data-line-id="__CHAT_ID__" href="__CHAT_LINK__" class="line_name  weight--semibold js-qrcode-window  u-text-5  u-color-dark">__LINE_NAME__</a><span class="u-block  u-color-muted  u-text-7"></span></div><div class="o-grid__item  u-flex  u-align-items-center  u-justify-content-end"><div class="u-padding-md  u-padding-ends-sm@mobile  u-padding-sides-xxs@mobile"><a target="_line" data-ga-event="ctr_line_lvl_2" data-line-id="__LINE_ID__" href="__LINE_LINK__" class="btn  btn--action js-qrcode-window  c-btn  c-btn--positive">__T_CHAT_NOW__</a></div></div></div></div>'.replace(/__LINE_NAME__/g,t.name).replace(/__LINE_LINK__/g,t.url).replace(/__LINE_ID__/g,t.phone).replace(/__T_CHAT_NOW__/g,iCarCTR.attributes.newctrChatNow)):e.push('<div class="o-grid  contact__item"><div class="o-grid__item  u-flex  u-align-items-center"><div class="u-padding-md  u-padding-ends-sm@mobile  u-padding-sides-xxs@mobile"><a data-ga-event="ctr_whatsapp_lvl_2" target="_wa" data-whatsapp-number="__CHAT_ID__" href="__CHAT_LINK__" class="whatsapp_name  contact__item-phones  u-text-semibold  u-text-5">__CHAT_ID_SHOW__</a><span class="u-block  u-color-muted  u-text-7"></span></div><div class="o-grid__item  u-flex  u-align-items-center  u-justify-content-end"><div class="u-padding-md  u-padding-ends-sm@mobile  u-padding-sides-xxs@mobile"><a target="_wa" data-ga-event="ctr_whatsapp_lvl_2" data-whatsapp-number="__CHAT_ID__" href="__CHAT_LINK__" class="c-btn  u-padding-xxs@mobile  c-btn--positive">__T_CHAT_NOW__</a></div></div></div></div>'.replace(/__CHAT_NAME__/g,t.name).replace(/__CHAT_LINK__/g,t.url).replace(/__CHAT_ID_SHOW__/g,t.phone.replace(/^(([^0-9]*[0-9]){4,4})([^0-9]*)[0-9]([^0-9]*)[0-9]([^0-9]*)[0-9]([^0-9]*)[0-9]/,"$1$3*$4*$5*$6*")).replace(/__CHAT_ID__/g,t.phone).replace(/__T_CHAT_NOW__/g,iCarCTR.attributes.newctrChatNow))})),e.length?e.join(""):null},iCarCTRMethod.toggleLineMessage=function(e){"open"===e?(iCarCTRMethod.jsLineMessageContainer.find(".c-collapse").addClass("in"),iCarCTRMethod.jsNewLineMessageContainer.find(".c-collapse").addClass("in"),iCarCTRMethod.jsLineMessageContainer.find(".c-accordion__head").addClass("toggler--active").attr("aria-expanded","false"),iCarCTRMethod.jsNewLineMessageContainer.find(".c-accordion__head").addClass("toggler--active").attr("aria-expanded","false")):(iCarCTRMethod.jsLineMessageContainer.find(".c-collapse").removeClass("in"),iCarCTRMethod.jsNewLineMessageContainer.find(".c-collapse").removeClass("in"),iCarCTRMethod.jsLineMessageContainer.find(".c-accordion__head").removeClass("toggler--active").attr("aria-expanded","false"),iCarCTRMethod.jsNewLineMessageContainer.find(".c-accordion__head").removeClass("toggler--active").attr("aria-expanded","false"))},iCarCTRMethod.renderViewLineBusiness=function(){var e,a,t=[];return iCarCTRMethod.checkLineAccount().length?(iCarCTRMethod.jsLineBusinessContainer.removeClass(iCarCTR.hideClass),iCarCTRMethod.jsNewLineBusinessContainer.removeClass(iCarCTR.hideClass),iCarCTRMethod.toggleLineMessage("close"),e=iCarCTRMethod.getLineUrl()?(a=iCarCTRMethod.getLineUrl(),iCarCTRMethod.getLineId()):(a=iCarCTRMethod.checkLineAccount()[0].url,iCarCTRMethod.checkLineAccount()[0].lineId),/(iPhone|Android|webOS|BlackBerry|iPod)/.test(navigator.userAgent)&&(lineMobileUrl=a.replace("http://line.me/ti/p/~","https://line.me/R/oaMessage/"),lineDefaultMessage=iCarCTR.attributes.defaultLineText,a=lineMobileUrl+"/?"+encodeURIComponent(lineDefaultMessage)),a='<div class="flexbox  u-flex  u-padding-top-sm"><div class="flexbox__item  soft-half--right  u-margin-right-xs"><svg class="icon-svg--line_ad  valign--middle  u-margin-right-xxs  u-margin-left-none  u-hide@mobile" width="64"  height="64"><use xlink:href="#icon-svg--line_ad"></use></svg></div><div class="flexbox__item "><h4 class="contact--line_ad-name  u-color-positive  u-margin-none  flush  js-line-username">'+e+'</h4><span>LINE@ Official Account</span></div></div><a href="'+a+'" data-ga-event="ctr_line_lvl_2" class="btn  btn--action  btn--full  c-btn  c-btn--positive  c-btn--full  push-half--top  u-margin-top-xs  u-margin-bottom-sm  js-qrcode-window">'+iCarCTR.attributes.newctrChatNow+"</a>",t.push(a)):($(".js-modal-dealer").addClass("is--fullscreen"),iCarCTRMethod.toggleLineMessage("open"),iCarCTRMethod.jsLineBusinessContainer.addClass(iCarCTR.hideClass),iCarCTRMethod.jsNewLineBusinessContainer.addClass(iCarCTR.hideClass)),t.length?t.join(""):null},iCarCTRMethod.renderViewLineMessage=function(){iCarCTRMethod.jsLineMessageContainer.find(".line--message--details").val(iCarCTR.attributes.defaultLineText),iCarCTRMethod.jsNewLineMessageContainer.find(".line--message--details").val(iCarCTR.attributes.defaultLineText)},iCarCTRMethod.checkLineAccount=function(){var e=[],a=iCarCTRMethod.getLineId();return a&&a.match(/^@/)&&e.push({url:"http://line.me/ti/p/"+a,lineId:a}),e},iCarCTRMethod.updateViewLineNumbers=function(){iCarCTRMethod.jsLineBusinessContainer.length&&iCarCTRMethod.jsLineBusinessContainer.html(iCarCTRMethod.renderViewLineBusiness()),iCarCTRMethod.jsLineMessageContainer.length&&iCarCTRMethod.renderViewLineMessage(),iCarCTRMethod.jsNewLineBusinessContainer.length&&iCarCTRMethod.jsNewLineBusinessContainer.html(iCarCTRMethod.renderViewLineBusiness()),iCarCTRMethod.jsNewLineMessageContainer.length&&iCarCTRMethod.renderViewLineMessage(),iCarCTRMethod.jsNewLineNumberContainer.length?iCarCTRMethod.jsNewLineNumberContainer.html(iCarCTRMethod.renderViewLineNumbers2()):iCarCTRMethod.jsLineNumberContainer.html(iCarCTRMethod.renderViewLineNumbers())},iCarCTRMethod.toggleLineButton=function(){Object.keys||(Object.keys=function(e){var a,t=[];for(a in e)e.hasOwnProperty(a)&&t.push(a);return t}),Object.keys(iCarCTRMethod.getLineNumbers()).length?iCarCTRMethod.jsNCFLineButtonContainer.removeClass(iCarCTR.hideClass):iCarCTRMethod.jsNCFLineButtonContainer.addClass(iCarCTR.hideClass)},iCarCTRMethod.getSellerStateAreaCity=function(){return{state:iCarFunctions.decrypt(iCarCTR.attributes.location),area:iCarFunctions.decrypt(iCarCTR.attributes.area),city:iCarCTR.attributes.city?iCarFunctions.decrypt(iCarCTR.attributes.city):null}},iCarCTRMethod.getSellerProfileType=function(){return iCarCTR.attributes.profileType?iCarFunctions.decrypt(iCarCTR.attributes.profileType):null},iCarCTRMethod.renderSellerDetail=function(){var e=(e='<div class="u-flex u-margin-top-md  u-padding-bottom-md  u-margin-bottom-xs"><div class="c-seller-avatar  c-avatar  c-avatar--64  c-avatar--entity  u-margin-right-md"><img src="https://images.unsplash.com/photo-1523728778454-06bedf489d10?ixlib=rb-0.3.5&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;s=08d2c6b85477ff3c82dd17d1f5c7111b&amp;auto=format&amp;fit=crop&amp;w=634&amp;q=80" height="64" width="64" alt="__SELLER_NAME__" /></div><div><h4 class="c-seller-name  u-text-5  u-margin-bottom-none">__SELLER_NAME__</h4><div class="c-seller-role">__SELLER_PROFILE_TYPE__</div><ul class="c-seller-location  c-breadcrumb  u-margin-bottom-none  u-margin-top-xs  u-text-7">__LOCATION__</ul></div></div>').replace(/__SELLER_NAME__/g,iCarCTRMethod.getSellerName()).replace(/__SELLER_PROFILE_TYPE__/g,iCarCTRMethod.getSellerProfileType()),a=[];return $.each(iCarCTRMethod.getSellerStateAreaCity(),(function(e,t){t&&a.push("<li>"+t+"</li>")})),e.replace(/__LOCATION__/g,a.join(""))},iCarCTRMethod.isNitroTheme=function(){return $(".use--nitro").length},iCarCTRMethod.applySellerDetail=function(){return!!iCarCTRMethod.isNitroTheme()&&iCarCTRMethod.jsDealerName.html(iCarCTRMethod.renderSellerDetail())},iCarCTRMethod.isChatAvailable=function(){return!!iCarCTRMethod.getChatId()},iCarCTRMethod.getChatId=function(){return iCarCTR.attributes.chatId},iCarCTRMethod.toggleChatButton=function(){iCarCTRMethod.jsInitiateChat.each((function(e,a){var t=$(a);t.parent().hasClass("contact__toggle")||(t=(a=t.attr("data-container"))?t.parents(a):t.parent(),iCarCTRMethod.isChatAvailable()?(t.removeClass(iCarCTRDefaults.hideClass),iCarCTRMethod.jsNCFButtonSendMessageFlow.parent().addClass(iCarCTRDefaults.hideClass)):(t.addClass(iCarCTRDefaults.hideClass),iCarCTRMethod.jsNCFButtonSendMessageFlow.parent().removeClass(iCarCTRDefaults.hideClass)))}))},iCarCTRMethod.getListingTitle=function(){return iCarCTR.attributes.title},iCarCTRMethod.getAdType=function(){return iCarCTR.attributes.adType},iCarCTRMethod.getPrice=function(){return iCarCTR.attributes.price?iCarFunctions.decrypt(iCarCTR.attributes.price):""},iCarCTRMethod.getMakeModel=function(){return iCarCTR.attributes.make+" "+iCarCTR.attributes.model},iCarCTRMethod.getVariant=function(){return iCarCTR.attributes.variant},iCarCTRMethod.getYear=function(){return iCarCTR.attributes.year},iCarCTRMethod.getModalContextUrl=function(){return iCarCTRMethod.modal.length?iCarCTRMethod.modal.context.URL:""},iCarCTRMethod.getSellerId=function(){return iCarCTR.attributes.sellerId},iCarCTRMethod.getProfileId=function(){return iCarCTR.attributes.profileId},iCarCTRMethod.getState=function(){return iCarCTR.attributes.location?iCarFunctions.decrypt(iCarCTR.attributes.location):""},iCarCTRMethod.getArea=function(){return iCarCTR.attributes.area?iCarFunctions.decrypt(iCarCTR.attributes.area):""},iCarCTRMethod.getCity=function(){return iCarCTR.attributes.city?iCarFunctions.decrypt(iCarCTR.attributes.city):""},iCarCTRMethod.getLocation=function(){var e=" &raquo; ",a=iCarCTRMethod.getState();return a+=e+iCarCTRMethod.getArea(),{text:a+=e+iCarCTRMethod.getCity(),state:iCarCTRMethod.getState(),area:iCarCTRMethod.getArea(),city:iCarCTRMethod.getCity()}},iCarCTRMethod.setDealerSection=function(){var e=iCarCTRMethod.getLocation();return $(".js-contact-dealer-name").html(iCarCTRMethod.getSellerName()),$(".js-contact-dealer-location").html(e.text),$(".js-seller-profile-type").html(iCarCTRMethod.getSellerProfileType()),iCarCTR.attributes.listingTrusted?$(".js-contact-trusted-dealer").removeClass("u-hide visuallyhidden"):$(".js-contact-trusted-dealer").addClass("u-hide visuallyhidden"),{dealerName:iCarCTRMethod.getSellerName(),location:e}},window.iCarCTRModalOnOpen=function(){function e(){if(void 0!==window.iCarCTRJumperName)switch(window.iCarCTRJumperName){case"phone":iCarCTRMethod.CTRPhone();break;case"whatsapp":case"line":iCarCTRMethod.CTRWhatsapp()}}console.log("Track Open Modal",window.iCarCTRJumperName),0<=location.pathname.indexOf("/dealer/")?setTimeout((function(){e(),window.bmwShowMessageButton()}),0):(e(),"line"!==window.iCarCTRJumperName&&window.bmwShowMessageButton())},window.bmwShowMessageButton=function(){iCarCTR.attributes.isbmw?($(".js-contact-message").removeClass(iCarCTR.hideClass),$(".js-contact-message  .flexbox__item").removeClass(iCarCTR.hideClass),$(".js-ncf-option-send-message-flow  .js-update-profile").removeClass(iCarCTR.hideClass)):$(".js-contact-message").addClass(iCarCTR.hideClass)};var $body=$("body"),$contactForm=$(".contact--form"),$jsDealerLead=$(".js-dealer-lead"),$jsAdditionalMessageView=$(".js-additional-message-view"),$jsUpdateProfileContainer=$(".js-update-profile"),$jsUpdateProfileView=$(".js-update-profile-view"),$jsProfileUpdateMessageSent=$(".js_profile_update_message-sent"),$jsMoreInfoOption=$(".js-more-info-option"),$jsFormElementAdditionalMessage=$(".js-form-element-additional-message"),$jsBtnAdditionalInfo=$(".js-btn-additional-info"),$termsId=$("#terms"),$modalDestroy=$(".js-modal-dealer .js-modal-destroy"),$jsFormErrorCommon=$(".js-option-form-error");$dealerModal.iCarParams={listingId:"",sellerId:"",adType:""};var dealerCaptcha=null,ctr_id_bs_modal="#modal-contact-seller",ctr_bs_modal=$(ctr_id_bs_modal),is_bs_modal=ctr_bs_modal.length&&ctr_bs_modal.hasClass("c-modal");function contactItemMarkup(e,a,t,i,n,r){window.iCarAsiaParameters.CTRModalPhoneRegex,a.number=a.number.toString().replace(window.iCarAsiaParameters.CTRModalPhoneRegex.find,window.iCarAsiaParameters.CTRModalPhoneRegex.replace),t=void 0!==a.line_number?a.line_number:"main_phone"!=e&&"mobile"!=e||!t?"":t;var s="";return(void 0!==a.line_number&&a.line_number||("main_phone"==e||"mobile"==e)&&t)&&(s=s+'<div class="flexbox__item  text--center"><a data-ga-event="ctr_line_lvl_2" target="_line" data-line-id="'+t+'" href="http://line.me/ti/p/~'+t+'" class="btn  btn--app  js-qrcode-window"><span class="btn__icon  icon  icon--line"></span></a></div>'),"whats_app"!=e&&-1===iCarCTRMethod.getWhatsapp().indexOf(a.number)||(e="//web.whatsapp.com/send?phone=",s=s+'<div class="flexbox__item  text--center"><a data-ga-event="ctr_whatsapp_lvl_2" target="_whatsapp" href="'+((e=/(iPhone|Android|webOS|BlackBerry|iPod)/.test(navigator.userAgent)?"https://api.whatsapp.com/send?phone=":e)+a.number.replace(/[\- ]/g,"").replace(/^\+?0/g,window.iCarAsiaParameters.phonePrefix))+"&text="+n+'" class="btn  btn--app"><span class="btn__icon  icon  icon--whatsapp"></span></a></div>'),'<div class="contact__item  flexbox"><div class="flexbox__row"><div class="flexbox__item"><a data-ga-event="ctr_call_lvl_2" href="tel:'+a.number.replace(/[\- ]/g,"")+'" class="btn  btn--action  text--center" data-ga-click-type="cad-cal" data-ga-click-id="'+r+'"><span class="icon  icon--call  flush"></span></a></div><div class="flexbox__item  one-whole"><a data-ga-event="ctr_call_lvl_2" href="tel:'+a.number.replace(/[\- ]/g,"")+'" class="number  weight--semibold" data-ga-click-type="cad-cal" data-ga-click-id="'+r+'">'+a.number+'</a><div class="contact__meta  muted  milli">'+(void 0!==a.name?"<span>"+a.name+"</span>":"")+(t?"<span>Line ID: "+t+"</span>":"")+"</div></div>"+s+"</div>"}function showAdditionalMessageView(){$jsAdditionalMessageView.removeClass(iCarCTR.hideClass)}function hideAdditionalMessageView(){$jsAdditionalMessageView.addClass(iCarCTR.hideClass)}function showUpdateProfileView(){$jsUpdateProfileView.removeClass(iCarCTR.hideClass)}function hideUpdateProfileView(){$jsUpdateProfileView.addClass(iCarCTR.hideClass)}function showMessageSentView(){$jsProfileUpdateMessageSent.removeClass(iCarCTR.hideClass),$jsUpdateProfileContainer.addClass(iCarCTR.hideClass),hideAdditionalMessageView(),$(".js-contact--phones").addClass(iCarCTR.hideClass),iCarCTRMethod.jsDealerName.addClass(iCarCTR.hideClass)}function hideMessageSentView(){showAdditionalMessageView(),$(".js-contact--phones").removeClass(iCarCTR.hideClass),iCarCTRMethod.jsDealerName.removeClass(iCarCTR.hideClass)}function disableProfileUpdateForm(){$(".js-profile-update-modal__form").addClass(iCarCTR.hideClass),$body.removeClass("profile-update-required"),$(".js-chat-profile-update").removeClass("chat-backdrop is--active").removeClass("profile-update-backdrop")}function updateProfileData(e){$jsUpdateProfileView.find('input[name="userId"]').val(e.id)}$(document).ready((function(){function e(e){var a=e.attr("data-target-element"),t=e.attr("data-ga-show-id");(t=$(a||"article#listing_"+t)).length&&(iCarCTRAnalytic.dataLayerEcommerceClick(),window.location.href=t.attr("data-url")),window.location.href=e.attr("href")}is_bs_modal&&(ctr_bs_modal.on("shown.bs.modal",(function(){window.iCarWidgets.modal.current=ctr_bs_modal,window.iCarWidgets.modal.onOpen(ctr_id_bs_modal),"function"==typeof window.iCarCTRModalOnOpen&&window.iCarCTRModalOnOpen()})),ctr_bs_modal.on("hidden.bs.modal",(function(){$jsDealerLead.addClass(iCarCTR.hideClass),$jsFormElementAdditionalMessage.val(""),$jsAdditionalMessageView.find(".js-question-checkbox").attr("CHECKED",!1),$jsAdditionalMessageView.find("input").attr("disabled",!1),$jsUpdateProfileView.find(".listing__message").text(void 0!==params.contactLanguage["Continue to Message"]?params.contactLanguage["Continue to Message"]:"Continue to Message"),$jsBtnAdditionalInfo.text(void 0!==params.contactLanguage["Send Message"]?params.contactLanguage["Send Message"]:"Send Message"),$jsBtnAdditionalInfo.removeAttr("disabled"),$jsProfileUpdateMessageSent.addClass(iCarCTR.hideClass),iCarCTRMethod.onCTRTestClose(),hideUpdateProfileView(),hideMessageSentView(),showAdditionalMessageView(),window.iCarWidgets.modal.onClose(),"function"==typeof window.iCarCTRModalOnClose&&window.iCarCTRModalOnClose()}))),$(".js-disable-form-submit").on("change",(function(e){$(this).prop("checked")?$('button[type="submit"]',$dealerModal).removeAttr("disabled"):$('button[type="submit"]',$dealerModal).attr("disabled","disabled")})),iCarCTRMethod.isLogin()&&iCarCTRMethod.profileDataCheck((function(e){updateProfileData(e),iCarCTRMethod.updateProfileData(e)})),$("body").on("click",".js-ellipsize-text",(function(a){a.preventDefault(),e($(this))})),$("body").on("click",".listing__overlay",(function(a){a.preventDefault(),e($(this))})),$("body").on("click",".js-copy-message",(function(e){e.preventDefault();e=$(".line--message--details");var a=$(".overlay_message");e.select(),document.execCommand("copy"),a.removeClass(iCarCTR.hideClass),setTimeout((function(){a.addClass(iCarCTR.hideClass)}),2e3)})),$("body").on("click",".js-contact-seller",(function(e){e.preventDefault(),$(".js-modal-dealer").removeClass("is--fullscreen"),is_bs_modal&&($(this).hasClass("ndp--ctr")||ctr_bs_modal.modal("show"));var a,t,i,n,r,s,o,l,d,c,u=$(this),p=u.attr("data-target-element"),C=u.attr("data-listing-id"),m=$(p||"article#listing_"+C);iCarCTR.attributes=$('.js--listing[data-listing-id="'+m.attr("data-listing-id")+'"]').data(),iCarCTRChat={},$(".js-chat-profile-close").click(),iCarCTRMethod.isLogin((function(){$(".js-user-signin").addClass(iCarCTR.hideClass),$(".js-terms").removeClass(iCarCTR.hideClass)}),(function(){$(".js-user-signin").removeClass(iCarCTR.hideClass),$(".js-terms").addClass(iCarCTR.hideClass)})),$dealerModal.iCarParams&&$dealerModal.iCarParams.listingId===m.attr("data-listing-id")||($dealerModal.iCarParams.listingId=m.attr("data-listing-id"),$dealerModal.iCarParams.sellerId=m.attr("data-seller-id"),$dealerModal.iCarParams.username=m.attr("data-seller-username"),$dealerModal.iCarParams.name=m.attr("data-seller-name"),$dealerModal.iCarParams.adType=m.attr("data-ad-type"),$dealerModal.iCarParams.listingStatus=m.attr("data-listing-status"),$dealerModal.iCarParams.chatId=m.attr("data-chat-id"),$dealerModal.iCarParams.dataDisplayTitle=m.attr("data-display-title"),$dealerModal.iCarParams.listingImageThumb=m.attr("data-compare-image"),$dealerModal.iCarParams.phones=JSON.parse(iCarFunctions.decrypt(m.attr("data-phones"))),$dealerModal.iCarParams.price=m.attr("data-price-raw")?iCarFunctions.decrypt(m.attr("data-price-raw")):m.attr("data-price")?iCarFunctions.decrypt(m.attr("data-price")):"",$dealerModal.iCarParams.vehicleType=m.attr("data-vehicle-type"),$dealerModal.iCarParams.phoneWhatsapp=iCarFunctions.decrypt(m.data("phone-whatsapp")),$dealerModal.iCarParams.sellerName=iCarFunctions.decrypt(m.data("seller-name")),$dealerModal.iCarParams.isViewStore=m.data("view-store"),$dealerModal.iCarParams.brand=m.attr("data-make")+" "+m.attr("data-model"),$dealerModal.iCarParams.year=m.attr("data-year"),$dealerModal.iCarParams.variant=m.attr("data-variant"),a=iCarFunctions.decrypt(m.data("line-id")),$dealerModal.iCarParams.lineId=a,t=u.data("phone-only"),$('input[name="profileId"]',$dealerModal).val(m.attr("data-profile-id")),$('input[name="sellerId"]',$dealerModal).val(m.attr("data-seller-id")),$('input[name="listingId"]',$dealerModal).val(m.attr("data-listing-id")),$('input[name="location"]',$dealerModal).val(m.attr("data-location")),$(".listing__overlay",$dealerModal).attr("href",m.attr("data-url")),$(".listing__img",$dealerModal).attr("src",m.attr("data-image-src")),$(".listing__title > a",$dealerModal).html(m.attr("data-display-title")),$(".listing__title > a",$dealerModal).attr("href",m.attr("data-url")),l="true"==m.attr("data-listing-trusted"),$(".js-dealer__type",$dealerModal).removeClass("is--verified"),l&&$(".js-dealer__type",$dealerModal).addClass("is--verified"),(i=$(".listing__seller-name",$dealerModal)).addClass(iCarCTR.hideClass).html(""),$dealerModal.iCarParams.isViewStore&&$dealerModal.iCarParams.sellerName&&i.removeClass(iCarCTR.hideClass).html($dealerModal.iCarParams.sellerName),e="",p="true"==m.attr("data-hot-deal"),l="true"==$(".listing__location").attr("data-hide-areaCity"),i="true"==$(".listing__installment").attr("data-show-installment"),$dealerModal.removeClass("modal--dealer-hot-deal"),p?($dealerModal.addClass("modal--dealer-hot-deal"),$(".listing__price",$dealerModal).removeClass(iCarCTR.hideClass),$(".listing__installment",$dealerModal).addClass(iCarCTR.hideClass),"true"==m.attr("data-hide-price")?(s=parseInt(m.attr("data-hide-price-hours"),10),n=parseInt(m.attr("data-hide-price-days"),10),o=m.attr("data-hide-price-hours-title"),r=m.attr("data-hide-price-days-title"),e+='<span class="hot-deal  hot-deal--time-left">',0<n&&(e+=n+' <span class="hot-deal__text  weight--normal">'+r+"</span>"),0<s&&(e+=" "+s+' <span class="hot-deal__text  weight--normal">'+o+"</span>"),e+='<span class="hot-deal__tip  milli  weight--normal">'+m.attr("data-hide-price-title")+"</span>",e+="</span>"):(n=m.attr("data-hot-deal-actual-price"),r=m.attr("data-hot-deal-actual-price-title"),e+='<div class="hot-deal  '+((o=0<(s=parseFloat(m.attr("data-hot-deal-discount")))&&0!=n)?"hot-deal--discount":"")+'">',o&&(e+='<span class="hot-deal__actual-price  weight--normal">'+n+"</span>",e+=' <span class="hot-deal__label  micro">'+r+"</span>"),e+='<span class="hot-deal__price  push-half--right">',o&&(e+='<span class="hot-deal__percent  micro">-'+s+"%</span> "),e+=m.attr("data-price")+"</span>",o||i&&(e+='<p class="listing__installment  flush  weight--light">'+m.attr("data-installment")+"</p>"),e+="</div>"),$(".listing__price",$dealerModal).html(e)):0<(e=parseInt(m.attr("data-price-raw"),10))?($(".listing__price",$dealerModal).removeClass(iCarCTR.hideClass),$(".listing__price",$dealerModal).html(m.attr("data-price")),1<e&&i&&($(".listing__installment",$dealerModal).removeClass(iCarCTR.hideClass),$(".listing__installment",$dealerModal).html(m.attr("data-installment")))):($(".listing__price",$dealerModal).addClass(iCarCTR.hideClass),$(".listing__installment",$dealerModal).addClass(iCarCTR.hideClass)),$(".listing__seller-type",$dealerModal).html(iCarFunctions.decrypt(m.attr("data-profile-type"))),"Private"==iCarFunctions.decrypt(m.attr("data-profile-type"))||""==iCarFunctions.decrypt(m.attr("data-profile-type"))?$(".private-essential-services").removeClass(iCarCTR.hideClass):$(".private-essential-services").addClass(iCarCTR.hideClass),l?$(".listing__location",$dealerModal).html(iCarFunctions.decrypt(m.attr("data-location"))):(l=iCarFunctions.decrypt(m.attr("data-location")),""!=m.attr("data-area")&&(l+=" &raquo; "+iCarFunctions.decrypt(m.attr("data-area"))),""!=m.attr("data-city")&&(l+=" &raquo; "+iCarFunctions.decrypt(m.attr("data-city"))),$(".listing__location",$dealerModal).html(l)),$phone=iCarFunctions.decrypt(m.attr("data-phone")),$phone="01"==$phone.substring(0,2)?$phone.replace(/(\d{3})(\d)/,"$1-$2"):$phone,$(".listing__call",$dealerModal).html($phone),0<$(".js-mobile-listing__call",$dealerModal).length&&($(".js-mobile-listing__call",$dealerModal).attr("href","tel:"+$phone),$(".js-mobile-listing__call",$dealerModal).attr("data-ga-click-id",C)),d=m.attr("data-default-whatsapp-text"),c=$(".js-ncf-modal-body--default .js-contact--phones .contact__group",$dealerModal),m=$(".js-contact--show-more-button",$dealerModal),$("#toggle-contact-phones",$dealerModal).prop("checked",!1),c.length&&(c.html(""),m.addClass(iCarCTR.hideClass),$dealerModal.iCarParams.phones&&$.each($dealerModal.iCarParams.phones,(function(e,t){c.append(contactItemMarkup(t.type,t,a,$dealerModal.iCarParams,d,C))})),hiddenLength=0==t?2:7,Object.keys(iCarCTRMethod.getPhoneNumbers()).length>hiddenLength&&m.removeClass(iCarCTR.hideClass),$.each(c.find(".contact__item"),(function(e,a){e>hiddenLength-1&&$(a).addClass("hidden")}))),$("#remarks",$dealerModal).val(""),$(".js-disable-form-submit").attr("checked","checked"),$('button[type="submit"]',$dealerModal).removeAttr("disabled"),$(".js-form-error",$dealerModal).addClass(iCarCTR.hideClass),$(".js-form-success",$dealerModal).addClass(iCarCTR.hideClass),$(".js-form-error-common",$dealerModal).addClass(iCarCTR.hideClass),$(".input",$dealerModal).removeClass("input--error"),$chatOption=$(".js-chat-option",$dealerModal),$messageOption=$(".js-dealer-lead",$dealerModal),0!=t?($chatOption.addClass(iCarCTR.hideClass),$messageOption.addClass(iCarCTR.hideClass)):0!=$dealerModal.iCarParams.chatId&&"car"===$dealerModal.iCarParams.vehicleType?($chatOption.removeClass(iCarCTR.hideClass),$messageOption.addClass(iCarCTR.hideClass),$jsUpdateProfileContainer.addClass(iCarCTR.hideClass),$(".js-initiate-chat",$dealerModal).attr("data-ga-click-id",C)):(!1===$contactForm.hasClass("js-additional-message")&&$messageOption.removeClass(iCarCTR.hideClass),$chatOption.addClass(iCarCTR.hideClass),$jsUpdateProfileContainer.removeClass(iCarCTR.hideClass)),"function"==typeof iCarCTRMethod.toggleLineButton&&(iCarCTRMethod.toggleLineButton(),iCarCTRMethod.isNitroTheme()&&iCarCTRMethod.applySellerDetail(),iCarCTRMethod.setDealerSection())),"undefined"!=typeof grecaptcha&&document.getElementById("g-dealer-recaptcha")&&(null==dealerCaptcha?dealerCaptcha=grecaptcha.render("g-dealer-recaptcha",{sitekey:window.iCarAsiaParameters.reCaptchaKey}):grecaptcha.reset(dealerCaptcha)),clickTrack(this),is_bs_modal||($dealerModal.removeClass(iCarCTR.hideClass),window.iCarWidgets.popup.current=$dealerModal.bPopup({modalClose:!0,positionStyle:"fixed",position:["auto","35%"],easing:"easeOutBack",speed:0,onOpen:function(){$("html, body, main").addClass("no--overflow"),window.iCarWidgets.popup.onOpen(u.attr("class")),"function"==typeof window.iCarCTRModalOnOpen&&window.iCarCTRModalOnOpen()},onClose:function(){$("html, body, main").removeClass("no--overflow"),window.iCarWidgets.popup.onClose(),iCarCTRMethod.onCTRTestClose(),"function"==typeof window.iCarCTRModalOnClose&&window.iCarCTRModalOnClose()}})),iCarCTRMethod.isLogin()&&iCarCTRMethod.profileDataCheck((function(e){updateProfileData(e),iCarCTRMethod.updateProfileData(e)})),iCarCTRAnalytic.dataLayerEcommerceClick(),iCarCTRAnalytic.dataLayerEcommerceAdd()})),$modalDestroy.on("click",(function(e){e.preventDefault(),$jsDealerLead.addClass(iCarCTR.hideClass),$jsFormElementAdditionalMessage.val(""),$jsAdditionalMessageView.find(".js-question-checkbox").attr("CHECKED",!1),$jsAdditionalMessageView.find("input").attr("disabled",!1),$jsUpdateProfileView.find(".listing__message").text(void 0!==params.contactLanguage["Continue to Message"]?params.contactLanguage["Continue to Message"]:"Continue to Message"),$jsBtnAdditionalInfo.text(void 0!==params.contactLanguage["Send Message"]?params.contactLanguage["Send Message"]:"Send Message"),$jsBtnAdditionalInfo.removeAttr("disabled"),$jsProfileUpdateMessageSent.addClass(iCarCTR.hideClass),iCarCTRMethod.onCTRTestClose(),hideUpdateProfileView(),hideMessageSentView(),showAdditionalMessageView()})),$jsMoreInfoOption.on("click",".js-question-checkbox",(function(e){var a,t=$(this).val().trim();!0===$(this).is(":checked")?0<$jsFormElementAdditionalMessage.val().trim().length?$jsFormElementAdditionalMessage.val(t+"\n"+$jsFormElementAdditionalMessage.val()):$jsFormElementAdditionalMessage.val(t):(t=t.replace(/(\r\n|\n|\r)/gm,""),(a=$jsFormElementAdditionalMessage.val().trim().split("\n")).splice(a.indexOf(t),1),a=a.join("\n"),$jsFormElementAdditionalMessage.val(a))})),$jsBtnAdditionalInfo.on("click",(function(){return iCarCTRMethod.isLogin()?($(".js-user-signin").addClass("alert--default"),$(".js-user-signin").removeClass("alert--error"),0===$jsFormElementAdditionalMessage.val().length?($jsFormErrorCommon.removeClass(iCarCTR.hideClass).text(void 0!==params.contactLanguage["Please enter message or select check box questions."]?params.contactLanguage["Please enter message or select check box questions."]:"Please enter message or select check box questions."),0):$jsFormElementAdditionalMessage.val().length<7?($jsFormErrorCommon.removeClass(iCarCTR.hideClass).text(void 0!==params.contactLanguage["Your message is too short."]?params.contactLanguage["Your message is too short."]:"Your message is too short"),0):($jsFormErrorCommon.addClass(iCarCTR.hideClass),0==$termsId.prop("checked")?($jsFormErrorCommon.removeClass(iCarCTR.hideClass).text($termsId.data("error")),0):($jsFormErrorCommon.addClass(iCarCTR.hideClass),void(iCarCTRMethod.isProfileComplete()?($jsBtnAdditionalInfo.attr("disabled",!0).text(void 0!==params.contactLanguage["Sending Message..."]?params.contactLanguage["Sending Message..."]:"Sending Message..."),$jsAdditionalMessageView.find("input").attr("disabled",!0),iCarCTRAnalytic.postLeadMessage((function(e,a,t){console.log("__GA_SND_MSG_LEAD__",{eventCategory:"New CTR Flow",eventAction:"Level 2 Message Lead Click"}),gaPush({eventCategory:"New CTR Flow",eventAction:"Level 2 Message Lead Click"}),iCarCTRAnalytic.dataLayerEcommerceCheckout({step:1,option:"Message"},"ecommerce_checkout"),iCarCTRAnalytic.dataLayerEcommerceCheckout({id:iCarCTRMethod.generateRandomId(),affiliation:"Web",revenue:"1",tax:"0.00",shipping:"0.00"},"ecommerce_purchase"),iCarCTRAnalytic.postLeadDealer(e),hideAdditionalMessageView(),showMessageSentView()}),(function(e,a,t){$jsFormErrorCommon.removeClass(iCarCTR.hideClass).text(e.responseJSON.message),$jsBtnAdditionalInfo.removeAttr("disabled").text(void 0!==params.contactLanguage["Send Message"]?params.contactLanguage["Send Message"]:"Send Message"),$jsAdditionalMessageView.find("input").removeAttr("disabled")}),{},{remarks:$jsFormElementAdditionalMessage.val()})):(hideAdditionalMessageView(),$jsUpdateProfileView.find("#update-profile-name").val(iCarCTR.profileData.name),$jsUpdateProfileView.find("#update-profile-phone").val(iCarCTR.profileData.phone),iCarCTR.profileData.name?($jsUpdateProfileView.find(".js-update-profile-name-block").addClass(iCarCTR.hideClass),$jsUpdateProfileView.find("#update-profile-name").removeClass("js-form-element-required")):$jsUpdateProfileView.find(".js-update-profile-name-block").removeClass(iCarCTR.hideClass),iCarCTR.profileData.phone?($jsUpdateProfileView.find("#update-profile-phone").removeClass("js-form-element-required"),$jsUpdateProfileView.find(".js-update-profile-phone-block").addClass(iCarCTR.hideClass)):$jsUpdateProfileView.find(".js-update-profile-phone-block").removeClass(iCarCTR.hideClass),iCarCTR.profileData.email.length<3?($jsUpdateProfileView.find(".js-update-profile-email").removeClass(iCarCTR.hideClass),$jsUpdateProfileView.find("#update-profile-email").addClass("js-form-element-required")):($jsUpdateProfileView.find(".js-update-profile-email").addClass(iCarCTR.hideClass),$jsUpdateProfileView.find("#update-profile-email").removeClass("js-form-element-required")),showUpdateProfileView()))))):($(".js-user-signin").removeClass("alert--default"),$(".js-user-signin").addClass("alert--error"),!1)})),iCarCTRMethod.jsNCFButtonSendMessageFlow.on("click",(function(e){e.preventDefault(),$(".js-modal-dealer").addClass("is--fullscreen"),iCarCTRMethod.jsNCFOptionSendMessageFlow.removeClass(iCarCTR.hideClass),iCarCTRMethod.setModalPositionTop()})),iCarCTRMethod.getUserInputLineNumber()&&iCarCTRMethod.jsNCFInputLineNumber.val()&&iCarCTRMethod.setUserInputLineNumber(iCarCTRMethod.jsNCFInputLineNumber.val()),iCarCTRMethod.jsNCFInputLineNumber.on("keyup",(function(e){iCarCTRMethod.setUserInputLineNumber($(this).val())}))})),$("body").on("click",'[data-ga-event="ctr_call_lvl_1"]',(function(){iCarCTRAnalytic.postLead("ctr_call_lvl_1")})),$("body").on("click",'[data-ga-event="ctr_call_lvl_2"]',(function(){iCarCTRAnalytic.postLead("ctr_call_lvl_2")})),$("body").on("click",'[data-ga-event="ctr_line_lvl_1"]',(function(){iCarCTRAnalytic.postLead("ctr_line_lvl_1")})),$("body").on("click",'[data-ga-event="ctr_line_lvl_2"]',(function(){iCarCTRAnalytic.postLead("ctr_line_lvl_2"),$(this).data("lineId")&&iCarCTRAnalytic.postLeadLine($(this).data("lineId"))})),$("body").on("click",'[data-ga-event="ctr_whatsapp_lvl_2"]',(function(){iCarCTRAnalytic.postLead("ctr_whatsapp_lvl_2"),$(this).data("whatsappNumber")&&iCarCTRAnalytic.postLeadLine($(this).data("whatsappNumber"))})),$("body").on("click",'[data-ga-event="ctr_message_lvl_1"]',(function(){iCarCTRAnalytic.postLead("ctr_message_lvl_1")})),$("body").on("click",'[data-ga-event="ctr_message_lvl_2"]',(function(){iCarCTRAnalytic.postLead("ctr_message_lvl_2")})),window.iCarCTRChat={},$("body").on("click",'[data-ga-event="ctr_chat_lvl_1"]',(function(){iCarCTRAnalytic.postLead("ctr_chat_lvl_1"),iCarCTRChat=iCarCTR.attributes})),$("body").on("click","div.contact__item span.icon--call",(function(){iCarCTRAnalytic.dataLayerEcommerceCheckout({step:1,option:"Phone"},"ecommerce_checkout"),iCarCTRAnalytic.dataLayerEcommerceCheckout({id:iCarCTRMethod.generateRandomId(),affiliation:"Web",revenue:"1",tax:"0.00",shipping:"0.00"},"ecommerce_purchase")})),$("body").on("click","div.contact__item span.icon--whatsapp",(function(e){iCarCTRAnalytic.dataLayerEcommerceCheckout({step:1,option:"Whatsapp"},"ecommerce_checkout"),iCarCTRAnalytic.dataLayerEcommerceCheckout({id:iCarCTRMethod.generateRandomId(),affiliation:"Web",revenue:"1",tax:"0.00",shipping:"0.00"},"ecommerce_purchase")})),$("body").on("click","div.contact__item span.icon--line",(function(){iCarCTRAnalytic.dataLayerEcommerceCheckout({step:1,option:"Line"},"ecommerce_checkout"),iCarCTRAnalytic.dataLayerEcommerceCheckout({id:iCarCTRMethod.generateRandomId(),affiliation:"Web",revenue:"1",tax:"0.00",shipping:"0.00"},"ecommerce_purchase")})),window.profileUpdateSuccess=function(e,a,t){showMessageSentView(),hideUpdateProfileView(),disableProfileUpdateForm(),(new HeaderView).render(e),updateProfileData(e.userData),iCarCTRMethod.updateProfileData(e.userData),iCarCTRAnalytic.postLeadDealer(e.lead),setTimeout((function(){$modalDestroy.click(),is_bs_modal&&ctr_bs_modal.modal("hide")}),2e3)},window.profileUpdateFailure=function(e,a,t){var i=$(".js-form-error-common"),n=$.parseJSON(e.responseText);$jsUpdateProfileView.find(".button__update").attr("enabled",!0).removeAttr("disabled").text(void 0!==params.contactLanguage["Send Message"]?params.contactLanguage["Send Message"]:"Send Message"),"object"==typeof n&&i.html(e.responseJSON.message).removeClass(iCarCTR.hideClass)},function(){function e(e,a,t,i){var n=0;if(e[t]&&e[t][i]){var r,s=e[t][i];for(r in s){if(a==r){n=s[r];break}r<a&&(n=s[r])}}return n}function a(e,a,t){return e.toFixed(a).toString().replace(/\B(?=(\d{3})+(?!\d))/g,t)}function t(e,a,t){return(e+e*(a/100)*t)/(12*t)}$(document).ready((function(){var i=$(".tool--loan"),n=$(".js-calculate-loan"),r=window.financeBanks,s=window.financeParams;if(!(i.length||void 0!==s&&s.hasOwnProperty("noCalculator")&&s.noCalculator))return!1;String.prototype.replaceAll=function(e,a){return this.replace(new RegExp(e,"g"),a)};var o,l=$(".listing__calculator"),d=$("#loan_price"),c=$("#loan_deposit"),u=$("#loan_interest"),p=$("#loan_period"),C=!1,m=!1;if(n.change(g).keyup(g),void 0!==s&&s.hasOwnProperty("noCalculator")&&s.noCalculator)for(var h in deposit=s.deposit,$i=0,deposit)deposit.hasOwnProperty(h)&&(0!==$i&&(m=C=!0),o=deposit[h],f()),$i++;else f();function g(){var e,a,t,n,r,s,o,l,C,m;e=$("#tool_loan").attr("data-thousand-separator"),a=d.val(),t=c.val().replaceAll(e,""),n=u.val(),r=($(".loan_period:checked").length?$(".loan_period:checked"):p).val(),s=parseInt(a,10),o=parseInt(t,10),l=parseFloat(n),C=parseInt(r,10),m=parseFloat($("#loan_interest").attr("data-max-interest"),10),e=parseInt($("#loan_period").attr("data-max-period"),10),""===a||""===t||isNaN(a)||isNaN(t)||s<0||o<0||s<=o?(console.log("standard error",a,t,s,o),$(".js-error-deposit").addClass("field--error").addClass("field--error_standard"),$(".js-error-deposit").removeClass("u-hide")):($(".js-error-deposit").removeClass("field--error").removeClass("field--error_standard"),$(".js-error-deposit").addClass("u-hide"),""===n||isNaN(n)||l<=0||m<l?($(".js-error-interest").addClass("field--error"),$(".js-error-interest").removeClass("u-hide")):($(".js-error-interest").removeClass("field--error"),$(".js-error-interest").addClass("u-hide"),""===r||isNaN(r)||C<=0||e<C?($(".js-error-period").addClass("field--error"),$(".js-error-period").removeClass("u-hide")):($(".js-error-period").removeClass("field--error"),$(".js-error-period").addClass("u-hide")))),i.find(".field--error").length||f()}function f(){var i=window.financeParams,n=$("#tool_loan").length?$("#tool_loan").attr("data-thousand-separator"):"",s=$("#loan_period").length?$("#loan_period").data("divider"):"",p=$("#loan_period").length?$("#loan_period").data("decimal-point"):"",h=c.length?c.val().replaceAll(n,""):0,g=$(".loan_period:checked").length?$(".loan_period:checked").val():$("#loan_period").length?$("#loan_period").val():"",f=u.length?u.val():0,_=d.length?d.val():iCarFunctions.decrypt($("article[data-listing-id]").attr("data-price-raw")),v="RM";void 0!==i&&i.hasOwnProperty("noCalculator")&&i.noCalculator&&(g=i.term,n=i.thousandSeparator,h=(_=0==_?i.amount:_)*o/100,p=i.decimalPoint,s=1,f=i.interest,v=i.currency);var w=parseInt(_,10),b=parseInt(g,10),T=parseInt(h,10),j=(s=parseInt(s,10),p=parseInt(p,10),f=parseFloat(f),w-T);0<(s=t(j,f,b/=s=0==s?1:s))&&($(".tool--loan input.gross-price").val(j),$(".tool--loan input.gross-price-formatted").val(a(j,p,n)),M=a(s,p,n),$(".tool--loan .raw-price").parent().removeClass("visuallyhidden"),$(".tool--loan input.raw-price").val(s),$(".tool--loan .raw-price:not(input)").html(M),l.find(".raw-price:not(input)").html(M));var y,R,M=$(".js-tools .bank_rate");if(M.length){M.removeClass("visuallyhidden");var x,k=i.type||"used",N=i.origin||"foreign",L=[];for(x in r){var A,P=r[x];P="BRI KKB"===x?(A=e(P,1,k,N),void 0,R=(_-15*_/100)*(12.48/100/12),y=1-Math.pow(1.0104,-72),Math.ceil(R/y)):(A=e(P,b,k,N),Math.round(t(j,A,b)));L.push({bank:x,rate:A,value:P}),gov=!0!==C?"-NO":"",$('.banks-list .js-bank-item[data-bank="'+x+'"]').attr("data-rate",A).find(".js-payment"+gov).text(v+" "+a(P,0,n))}L=L.sort((function(e,a){return e.value>a.value?1:-1})),"id"!==window.iCarAsiaParameters.countryCode&&$(".banks-list .js-bank-item").sort((function(e,a){var t,i,n=$(e).attr("data-bank"),r=$(a).attr("data-bank"),s=0;for(i in L)n==L[i].bank&&(t=i),r==L[i].bank&&(s=i);return s<t?1:-1})).appendTo(".banks-list");var D=0;$(".banks-list .js-bank-item").each((function(){var e=$(this),a=parseFloat(e.attr("data-rate")),t=e.find("a:first").attr("data-url"),n=$.extend({},i);n.bank=e.attr("data-bank"),n.price=w,n.term=b,n.deposit=Math.round(T/w*100),isNaN(n.deposit)&&(n.deposit="0");var r,s,o,l=function(e){if(!(e=e.search.slice(1)))return{};e=e.split("&");var a={};return e.forEach((function(e){e=e.split("="),a[e[0]]=decodeURIComponent(e[1]||"")})),JSON.parse(JSON.stringify(a))}(t=(r=t,(s=document.createElement("a")).href=r,s));for(o in n)l[o]=n[o];"BRI KKB"===l.bank&&(l.term=6,l.deposit=15),t.search="?"+$.param(l),t=t.href,(!0!==m?e.find("a:first"):e.find("a.url-gov")).attr("href",t),D<3&&0<a?($(this).show(),D++,$(".js-finance-widget").show()):($(this).hide(),$(".js-finance-widget").hide())}))}}}))}(),$(document).ready((function(){function e(e,a,t){return e?e*t+a:0}function a(e){var a,t;for(t in a=((e=e&&e.target||e||this)==window?$("div#tool_loan"):$(e).parents("div#tool_loan")).toArray()){var i=$(a[t]),n=i.find("[name=period]#loan_period").val(),r=(r=i.find("input#loan_interest").attr("data-dependency"))&&JSON.parse(iCarFunctions.decrypt(r)),s=parseInt(n,10);n=0;r&&r[s]?n=r[s]:r&&r.length&&(n=r.pop()),i.find("input#loan_interest").val(n).trigger("keyup")}}if($(document).on("keyup",".js-bri .js-calculate-loan",(function(a){var t=$(this).parents("#tool_loan"),i=t.find("input#loan_price").val(),n=t.find("input#loan_deposit").val(),r=t.find("input#loan_interest").val(),s=t.find("[name=period]#loan_period").val(),o=t.find("[name=period]#loan_period").data("divider"),l=t.find("[name=period]#loan_period").data("decimal-point"),d=parseInt(i,10),c=parseInt(n,10),u=parseFloat(r),p=parseInt(s,10),C=parseInt(o,10),m=parseInt(l,10),h=parseInt(t.find("input#loan_interest").attr("data-max-interest"),10),g=parseInt(t.find("[name=period]#loan_period").attr("data-max-period"),10),f=t.attr("data-thousand-separator");o=0,l=0;$(this).parents(".js-bri.js-loan-newcars").length?(o=15e5+.75*i*.01,l=.25):$(this).parents(".js-bri").length&&(o=1e6,l=.3),isNaN(i)||isNaN(n)||d<0||c<Math.round(e(d,o,l))||d<=c-o?t.find(".js-error-deposit").addClass("field--error"):(t.find(".js-error-deposit").removeClass("field--error"),isNaN(r)||u<=0||h<u?t.find(".js-error-interest").addClass("field--error"):(t.find(".js-error-interest").removeClass("field--error"),isNaN(s)||p<=0||g<p?t.find(".js-error-period").addClass("field--error"):(t.find(".js-error-period").removeClass("field--error"),d?0<(p=((o=d-c+o)+o*(u/100)*(p/=0===C?1:C))/(12*p))&&(p=p.toFixed(m).toString().replace(/\B(?=(\d{3})+(?!\d))/g,f),(t=($el=t.parents(".tool--loan"))?$el:t).find(".raw-price").html(p)):t.find(".raw-price").html("0"))))})),$(".js-bri #loan_period").length){for(var t in $elements=$(".js-bri #loan_period"),$elements.on("keyup change",a),$arr_elements=$elements.toArray(),$arr_elements)$arr_elements[t].selectize&&$arr_elements[t].selectize.$input.on("keyup change",a),a($arr_elements[t]);$(".js-bri.js-branding #loan_interest").prop("disabled",!0)}function i(a){var t,i;for(i in t=((a=a&&a.target||a||this)==window?$("div#tool_loan"):$(a).parents("div#tool_loan")).toArray()){var n=$(t[i]),r=parseInt(n.find("input#loan_deposit").val(),10),s=1e6,o=n.find("input#loan_price").val(),l=parseInt(o,10);o=.3;n.hasClass("js-loan-newcars")&&(s=15e5+.75*l*.01,o=.25),r<(o=Math.round(e(l,s,o)))||l<=r-s?n.find("input#loan_deposit").val(o).trigger("keyup"):n.find("input#loan_deposit").data("baseDeposit",0)}}$(".js-bri #loan_price").length&&(i(),$(".js-bri #loan_price").on("keyup",i)),$(this).on("pjax:end","body",(function(e,a){if("classified-listings-result"===$(e.target).attr("id")){$listings=$("article.js--listing").toArray();var t,n=null;for(t in $listings){var r=parseInt(iCarFunctions.decrypt($($listings[t]).attr("data-price-raw")),10);(null===n||r<n)&&(n=r)}var s=$("div#tool_loan input#loan_price").val(n);for(t in s.toArray())i(s)}})),$("input[data-deposit][data-price]").keyup((function(e){var a=$(this),t=$(a.attr("data-price")).val(),i=$(a.attr("data-deposit")),n=a.val();if(isNaN(parseInt(n))||n==parseInt(n).toString()||a.val(parseInt(n)),!isNaN(t)&&!isNaN(n)&&0<=n&&n<100)return e.preventDefault(),i.val(Math.ceil(t*n/100)),!1})).blur((function(){var e=$(this),a=e.val();isNaN(a)||e.val(Math.round(a))})).keydown((function(e){if((e=e||window.event).keyCode<48||57<e.keyCode)return 16==e.keyCode||37==e.keyCode||39==e.keyCode||8==e.keyCode||46==e.keyCode||(e.preventDefault(),!1)})),$("input[data-percentage][data-price]").keyup((function(e){var a=$(this),t=$(a.attr("data-price")).val(),i=$(a.attr("data-percentage"));a=a.val();if(!isNaN(t)&&!isNaN(a)&&parseInt(t)>parseInt(a)&&0<=a)return e.preventDefault(),i.val(Math.round(a/t*100)),!1})),$("input[data-price]").blur((function(e){var a=$(this);if(""==a.val()){var t=$(a.attr("data-deposit")),i=$(a.attr("data-percentage")),n=$(a.attr("data-price")).val();return t.length&&""!==t.val()&&!isNaN(t.val())&&0<parseInt(t.val())&&!isNaN(n)?(e.preventDefault(),a.val(Math.round(parseInt(t.val())/n*100)),!1):i.length&&""!==i.val()&&!isNaN(i.val())&&0<parseInt(i.val())&&!isNaN(n)?(e.preventDefault(),a.val(Math.ceil(n*parseInt(i.val())/100)),!1):void 0}})),$("input[data-deposit][data-price]").trigger("keyup"),$("input[data-percentage][data-deposit]").keyup((function(e){var a=$(this),t=$(a.attr("data-percentage")),i=$(a.attr("data-deposit"));a=parseInt(a.val()),t=parseInt(t.val());isNaN(t)||isNaN(a)||i.val(Math.ceil(t*a/100))})),$(".js-bca-cartype[data-year]").change((function(e){var a=$(this),t=$(a.attr("data-year"));"New"==a.val()?t.addClass("visuallyhidden"):t.removeClass("visuallyhidden")})).trigger("change")})),window.bcaFormLoader=function(){},window.bcaFormSuccess=function(e,a,t){try{if(Form.toggleFormActionButton($(".js-tools .bca [type=submit]"),!0),"object"==typeof e){if(e.SimulasiKreditResponse&&(e.SimulasiKreditResponse.ADDMList&&e.SimulasiKreditResponse.ADDMList.ADDM&&Array.isArray(e.SimulasiKreditResponse.ADDMList.ADDM)||e.SimulasiKreditResponse.ADDBList&&e.SimulasiKreditResponse.ADDBList.ADDB&&Array.isArray(e.SimulasiKreditResponse.ADDBList.ADDB.length))){function i(e,a,t){var i=null;if(Array.isArray(e))for(var n in e){var r=e[n];r.tenor&&r.tdp&&r.angsuranList.angsuran.angsuranPeriode1Fixed&&((n=a.clone().removeClass("js-ref")).find(".js-tenor").text(r.tenor.toString()+" thn"),n.find(".js-tdp").text("Rp. "+r.tdp.toString()),n.find(".js-apply").attr("href","/finance/submission?period="+r.tenor.toString()+"&"+t),r.angsuranList.angsuran.angsuranPeriode2Cap?(n.find(".js-angsuranPeriode1Fixed").text("Rp. "+r.angsuranList.angsuran.angsuranPeriode1Fixed.toString()),n.find(".js-angsuranPeriode2Cap").text("Rp. "+r.angsuranList.angsuran.angsuranPeriode2Cap.toString())):n.find(".js-angsuran").text("Rp. "+r.angsuranList.angsuran.angsuranPeriode1Fixed.toString()),i=n.add(i))}return i}$.fn.serializeObject||($.fn.serializeObject=function(){var e={},a=this.serializeArray();return $.each(a,(function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""})),e});var n=$(".js-calculator-modal .js-addb"),r=n.find(".js-ref").first(),s=0,o=null,l=$("form#calculatorbcamodel").serializeObject();if(delete l._csrf,l.listingId=parseInt($('meta[name="ga:cad:details:ad_id"]').attr("content")),isNaN(l.listingId)&&delete l.listingId,l=$.param(l),r.removeClass("visuallyhidden"),(o=i(e.SimulasiKreditResponse.ADDBList.ADDB,r,l+"&addb=1"))&&(s=o.length,d=n.find(".tool_body>.flexbox"),r.addClass("visuallyhidden"),d.not(".js-header, .js-ref").remove(),d.parent().append(o.get().reverse())),(r=(n=$(".js-calculator-modal .js-addm")).find(".js-ref").first()).removeClass("visuallyhidden"),o=i(e.SimulasiKreditResponse.ADDMList.ADDM,r,l)){var d=n.find(".tool_body>.flexbox");r.addClass("visuallyhidden"),d.not(".js-header").not(r).remove(),d.parent().append(o.get().reverse()),s||$(".js-calculator-modal .js-addb-tab").remove()}else{if(!s)throw"No Data to Show, please try again later or contact Our customer service";$(".js-calculator-modal .js-addm-tab").remove()}return void(window.iCarWidgets.popup.current=$("#js-calculator-modal").removeClass("visuallyhidden").bPopup({modalClose:!0,positionStyle:"fixed",onOpen:function(){$("html, body, main").addClass("no--overflow"),window.iCarWidgets.popup.onOpen($(this).attr("class"))},onClose:function(){$("html, body, main").removeClass("no--overflow"),window.iCarWidgets.popup.onClose()}}))}throw"Maaf, Simulasi kredit tidak tersedia untuk spesifikasi kendaraan ini"}if(100<e.length)throw console.log(e),"Unknow Error, please try again later or contact Our customer service";throw e}catch(e){bcaFormFailure(t,a,e)}},window.bcaFormFailure=function(e,a,t){if(console.log(e,a,t),$(".js-globalerror-bca").addClass("visuallyhidden").html(""),Form.toggleFormActionButton($(".js-tools .bca [type=submit]"),!0),e.responseJSON&&"success"!=a)for(var i in e.responseJSON){var n=i.split("-",2),r=$("#"+n[0]);n=$('[name="'+n[1]+'"]',r);(r=$(".js-error-"+n.attr("name"),r)).length&&(r.html(e.responseJSON[i][0]),r.removeClass("visuallyhidden")),n.length&&n[0].selectize?n[0].selectize.$control.addClass("input--error  is--error"):n.length&&(n.is(":visible")&&n.focus(),n.addClass("input--error  is--error"))}else"success"==a&&"string"==typeof t?$(".js-globalerror-bca").removeClass("visuallyhidden").html(t):$(".js-globalerror-bca").removeClass("visuallyhidden").html(e.responseText)},$(document).ready((function(){var e=$(".modal--report");$(".js-listing__report").on("click",(function(a){return a.preventDefault(),e.removeClass("visuallyhidden"),window.iCarWidgets.popup.current=e.bPopup({modalClose:!0,position:["auto","10%"],positionStyle:"fixed",onOpen:window.iCarWidgets.popup.onOpen($(this).attr("class")),onClose:window.iCarWidgets.popup.onClose()}),!1})),$(".js-report-ad").on("submit",(function(a){a.preventDefault();var t=$(this);return"failed"!=t.attr("form-validation")&&((a=t.serializeArray()).push({name:"_token",value:$('input[name="token"]',t).val()}),$.ajax({url:t.attr("action"),type:t.attr("method"),data:a,dataType:"json",complete:function(){$(".js-form-success",e).removeClass("visuallyhidden"),setTimeout((function(){e.close(),$("#report-ad-form").trigger("reset"),$(".js-form-success",e).addClass("visuallyhidden"),$(".js-report-ad-btn").prop("disabled",!1),$(".js-report-ad-btn").text("Report"),$("#report-ad-form").find("input, select").each((function(){var e=$(this);e.hasClass("js-selectize")&&e.selectize()[0].selectize.setValue("")}))}),3e3)}})),!1}))})),function(e){function a(a,i,n){var r=this;return this.on("click.pjax",a,(function(a){var s=e.extend({},_(i,n));s.container||(s.container=e(this).attr("data-pjax")||r),t(a,s)}))}function t(a,t,i){i=_(t,i);var r=a.currentTarget;if("A"!==r.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";1<a.which||a.metaKey||a.ctrlKey||a.shiftKey||a.altKey||location.protocol===r.protocol&&location.hostname===r.hostname&&(-1<r.href.indexOf("#")&&f(r)==f(location)||a.isDefaultPrevented()||(t={url:r.href,container:e(r).attr("data-pjax"),target:r},t=e.extend({},t,i),i=e.Event("pjax:click"),e(r).trigger(i,[t]),i.isDefaultPrevented()||(n(t),a.preventDefault(),e(r).trigger("pjax:clicked",[t]))))}function i(a,t,i){i=_(t,i);var r=a.currentTarget;t=e(r);if("FORM"!==r.tagName.toUpperCase())throw"$.pjax.submit requires a form element";if("GET"!==(t={type:(t.attr("method")||"GET").toUpperCase(),url:t.attr("action"),container:t.attr("data-pjax"),target:r}).type&&void 0!==window.FormData)t.data=new FormData(r),t.processData=!1,t.contentType=!1;else{if(e(r).find(":file").length)return;t.data=e(r).serializeArray()}n(e.extend({},t,i)),a.preventDefault()}function n(a){a=e.extend(!0,{},e.ajaxSettings,n.defaults,a),e.isFunction(a.url)&&(a.url=a.url());var t,i=a.target,r=g(a.url).hash,o=a.context=v(a.container);function l(a,t,n){return(n=n||{}).relatedTarget=i,n=e.Event(a,n),o.trigger(n,t),!n.isDefaultPrevented()}a.data||(a.data={}),e.isArray(a.data)?a.data.push({name:"_pjax",value:o.selector}):a.data._pjax=o.selector,a.beforeSend=function(e,i){if("GET"!==i.type&&(i.timeout=0),e.setRequestHeader("X-PJAX","true"),e.setRequestHeader("X-PJAX-Container",o.selector),!l("pjax:beforeSend",[e,i]))return!1;0<i.timeout&&(t=setTimeout((function(){l("pjax:timeout",[e,a])&&e.abort("timeout")}),i.timeout),i.timeout=0),i=g(i.url),r&&(i.hash=r),a.requestUrl=h(i)},a.complete=function(e,i){t&&clearTimeout(t),l("pjax:complete",[e,i,a]),l("pjax:end",[e,a])},a.error=function(e,t,i){var n=b("",e,a);i=l("pjax:error",[e,t,i,a]);"GET"==a.type&&"abort"!==t&&i&&s(n.url)},a.success=function(t,i,d){var c=n.state,u="function"==typeof e.pjax.defaults.version?e.pjax.defaults.version():e.pjax.defaults.version,p=d.getResponseHeader("X-PJAX-Version"),m=b(t,d,a),h=g(m.url);if(r&&(h.hash=r,m.url=h.href),u&&p&&u!==p)s(m.url);else if(m.contents){if(n.state={id:a.id||C(),url:m.url,title:m.title,container:o.selector,fragment:a.fragment,timeout:a.timeout},(a.push||a.replace)&&window.history.replaceState(n.state,m.title,m.url),e.contains(a.container,document.activeElement))try{document.activeElement.blur()}catch(t){}var f;m.title&&(document.title=m.title),l("pjax:beforeReplace",[m.contents,a],{state:n.state,previousState:c}),o.html(m.contents),(p=o.find("input[autofocus], textarea[autofocus]").last()[0])&&document.activeElement!==p&&p.focus(),(c=m.scripts)&&(f=e("script[src]"),c.each((function(){var a,t,i=this.src;f.filter((function(){return this.src===i})).length||(a=document.createElement("script"),(t=e(this).attr("type"))&&(a.type=t),a.src=e(this).attr("src"),document.head.appendChild(a))}))),p=a.scrollTo,r&&(c=decodeURIComponent(r.slice(1)),(c=document.getElementById(c)||document.getElementsByName(c)[0])&&(p=e(c).offset().top)),"number"==typeof p&&e(window).scrollTop(p),l("pjax:success",[t,i,d,a])}else s(m.url)},n.state||(n.state={id:C(),url:window.location.href,title:document.title,container:o.selector,fragment:a.fragment,timeout:a.timeout},window.history.replaceState(n.state,document.title)),p(n.xhr),n.options=a;var d,c,u=n.xhr=e.ajax(a);return 0<u.readyState&&(a.push&&!a.replace&&(d=n.state.id,c=m(o),T[d]=c,y.push(d),R(j,0),R(y,n.defaults.maxCacheLength),window.history.pushState(null,"",a.requestUrl)),l("pjax:start",[u,a]),l("pjax:send",[u,a])),n.xhr}function r(a,t){var i={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return n(e.extend(i,_(a,t)))}function s(e){window.history.replaceState(null,"",n.state.url),window.location.replace(e)}var o=!0,l=window.location.href,d=window.history.state;function c(a){o||p(n.xhr);var t=n.state,i=a.state;if(i&&i.container){if(o&&l==i.url)return;if(t){if(t.id===i.id)return;r=t.id<i.id?"forward":"back"}var r,d=T[i.id]||[];a=e(d[0]||i.container),d=d[1];a.length?(t&&function(e,a,t){var i;T[a]=t,e="forward"===e?(i=y,j):(i=j,y),i.push(a),(a=e.pop())&&delete T[a],R(i,n.defaults.maxCacheLength)}(r,t.id,m(a)),r=e.Event("pjax:popstate",{state:i,direction:r}),a.trigger(r),r={id:i.id,url:i.url,container:a,push:!1,fragment:i.fragment,timeout:i.timeout,scrollTo:!1},d?(a.trigger("pjax:start",[null,r]),(n.state=i).title&&(document.title=i.title),t=e.Event("pjax:beforeReplace",{state:i,previousState:t}),a.trigger(t,[d,r]),a.html(d),a.trigger("pjax:end",[null,r])):n(r),a[0].offsetHeight):s(location.href)}o=!1}function u(a){var t=e.isFunction(a.url)?a.url():a.url,i=a.type?a.type.toUpperCase():"GET",n=e("<form>",{method:"GET"===i?"GET":"POST",action:t,style:"display:none"});"GET"!==i&&"POST"!==i&&n.append(e("<input>",{type:"hidden",name:"_method",value:i.toLowerCase()}));var r,s=a.data;if("string"==typeof s)e.each(s.split("&"),(function(a,t){t=t.split("="),n.append(e("<input>",{type:"hidden",name:t[0],value:t[1]}))}));else if(e.isArray(s))e.each(s,(function(a,t){n.append(e("<input>",{type:"hidden",name:t.name,value:t.value}))}));else if("object"==typeof s)for(r in s)n.append(e("<input>",{type:"hidden",name:r,value:s[r]}));e(document.body).append(n),n.submit()}function p(a){a&&a.readyState<4&&(a.onreadystatechange=e.noop,a.abort())}function C(){return(new Date).getTime()}function m(e){var a=e.clone();return a.find("script").each((function(){this.src||jQuery._data(this,"globalEval",!1)})),[e.selector,a.contents()]}function h(e){return e.search=e.search.replace(/([?&])(_pjax|_)=[^&]*/g,""),e.href.replace(/\?($|#)/,"$1")}function g(e){var a=document.createElement("a");return a.href=e,a}function f(e){return e.href.replace(/#.*/,"")}function _(a,t){return a&&t?t.container=a:t=e.isPlainObject(a)?a:{container:a},t.container&&(t.container=v(t.container)),t}function v(a){if((a=e(a)).length){if(""!==a.selector&&a.context===document)return a;if(a.attr("id"))return e("#"+a.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+a.selector}function $(e,a){return e.filter(a).add(e.find(a))}function w(a){return e.parseHTML(a,document,!0)}function b(a,t,i){var n,r,s={},o=/<html/i.test(a);t=t.getResponseHeader("X-PJAX-URL");return s.url=t?h(g(t)):i.requestUrl,o?(r=e(w(a.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0])),n=e(w(a.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]))):r=n=e(w(a)),0===n.length||(s.title=$(r,"title").last().text(),i.fragment?(r="body"===i.fragment?n:$(n,i.fragment).first()).length&&(s.contents="body"===i.fragment?r:r.contents(),s.title||(s.title=r.attr("title")||r.data("title"))):o||(s.contents=n),s.contents&&(s.contents=s.contents.not((function(){return e(this).is("title")})),s.contents.find("title").remove(),s.scripts=$(s.contents,"script[src]").remove(),s.contents=s.contents.not(s.scripts)),s.title&&(s.title=e.trim(s.title))),s}d&&d.container&&(n.state=d),"state"in window.history&&(o=!1);var T={},j=[],y=[];function R(e,a){for(;e.length>a;)delete T[e.shift()]}function M(){return e("meta").filter((function(){var a=e(this).attr("http-equiv");return a&&"X-PJAX-VERSION"===a.toUpperCase()})).attr("content")}function x(){e.fn.pjax=a,e.pjax=n,e.pjax.enable=e.noop,e.pjax.disable=k,e.pjax.click=t,e.pjax.submit=i,e.pjax.reload=r,e.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:0,version:M},e(window).on("popstate.pjax",c)}function k(){e.fn.pjax=function(){return this},e.pjax=u,e.pjax.enable=x,e.pjax.disable=e.noop,e.pjax.click=e.noop,e.pjax.submit=e.noop,e.pjax.reload=function(){window.location.reload()},e(window).off("popstate.pjax",c)}e.inArray("state",e.event.props)<0&&e.event.props.push("state"),e.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),(e.support.pjax?x:k)()}(jQuery),window.iCarAsiaParameters.ajax={currentPage:window.location.href,domain:window.location.hostname,request:{push:!0,replace:!1,timeout:1e4},pageSettings:{listings:{display:"#classified-listings-result",triggers:{links:function(){},response:function(){var e=$(".js-sticky-ads-desktop");e.trigger("sticky_kit:detach"),window.iCarFunctions.selectize(".js-ajax"),window.iCarFunctions.sortBy(".js-ajax"),window.iCarFunctions.compare(),window.iCarFunctions.ellipsize(),window.iCarAsiaParameters.ajax.removeLoader(),$(window.iCarAsiaParameters.ajax.settings.display+" img").unveil(),window.iCarWidgets.facets.render(),window.iCarFunctions.facets(),window.iCarWidgets.breadcrumb.render(),console.log("sidebar check",$(".js-part-reviews").length),0!=$(".js-part-reviews").length&&window.iCarWidgets.expertReviews.render(),window.iCarWidgets.news.render(),$("head meta[name^=ga]").remove(),window.iCarFunctions.showCtr(),window.iCarFunctions.dealerInfoDetails(),window.iCarAjaxCall.elastic();var a=(e=$(".js-sticky-ads-desktop")).parents(".three-tenths"),t=a.siblings(".grid__item").height();"desktop"==adDevice&&t>a.height()+50&&e.stick_in_parent({parent:".container",offset:60,spacer:e.get(0)}),window.iCarWidgets.languageSwitcher.init(),window.iCarClassifiedListing=new ClassifiedListing}}},priceList:{display:"#pricing-models",triggers:{links:function(){},response:function(){window.iCarWidgets.languageSwitcher.init()}}}},settings:{},detectPage:function(){},addLoader:function(){$('<div class="loading-screen  c-preloader" style="z-index: 9999999"><div class="c-preloader__content"><div class="c-preloader__spinner"><div class="bounce  bounce--one"></div><div class="bounce  bounce--two"></div><div class="bounce  bounce--three"></div></div></div></div>').appendTo($(document.body)),$("html").addClass("no--overflow"),$("body").addClass("u-overflow-hidden")},addCustomLoader:function(e){$('<div class="loading-screen"></div>').appendTo($(e))},removeLoader:function(){$(".loading-screen").remove(),$("html").removeClass("no--overflow"),$("body").removeClass("u-overflow-hidden")}},window.iCarWidgets.facets={render:function(){$existing=$(".grid > .js-part-facets"),$existing.length&&$existing.remove(),$new=$(".js-ajax-part .js-part-facets"),$new.length&&$(".container--listing > .grid").prepend($new.eq(0))}},window.iCarWidgets.languageSwitcher={init:function(){$('head link[rel="alternate"][hreflang]').remove();var e=$("[lang].js-part-language-switcher--active"),a=$('body link[rel="alternate"][hreflang]').not('link[rel="alternate"][hreflang^='+e.attr("lang")+"]").not('link[rel="alternate"][hreflang=x-default]').toArray();if(a.length)for(index in a){var t=(i=$(a[index])).attr("hreflang").split("-")[0],i=i.attr("href");$(".js-part-language-switcher--"+t).attr("href",i),e.attr("href",window.location.href)}}},window.iCarWidgets.breadcrumb={render:function(){$existing=$(".container--listing > .js-part-breadcrumb"),$new=$(".js-ajax-part .js-part-breadcrumb"),$new.length&&$existing.html($new.html())}},window.iCarWidgets.news={render:function(){$unitBefore=$(".js-part-reviews").length?$(".js-part-reviews"):$(".js-ad-portrait"),$existing=$("aside .js-part-news"),$existing.length&&$existing.remove(),$new=$(".js-ajax-part .js-part-news"),$new.length&&$unitBefore.after($new.eq(0))}},window.iCarWidgets.expertReviews={render:function(){$existing=$("aside .js-part-reviews"),$existing.length&&$existing.remove(),$new=$(".js-ajax-part .js-part-reviews"),$new.length&&$(".js-ad-portrait").after($new.eq(0))}},window.iCarAsiaParameters.ajax.settings=window.iCarAsiaParameters.ajax.pageSettings.listings,$(document).ready((function(){window.iCarAsiaParameters.ajax.settings.triggers.links(),$clistings=$(window.iCarAsiaParameters.ajax.settings.display),$clistings.length&&($(document).pjax("body.smenu-v2--enabled .smenu a:not(.js-smenu__select--keyword .smenu__select__option__a)",window.iCarAsiaParameters.ajax.settings.display,window.iCarAsiaParameters.ajax.request),$(document).on("pjax:end","body.smenu-v2--enabled .js-smenu__select--keyword .smenu__select__option__a",window.iCarAsiaParameters.ajax.settings.triggers.response),$(document).pjax(".smenu a:not(body.smenu-v2--enabled .smenu a)",window.iCarAsiaParameters.ajax.settings.display,window.iCarAsiaParameters.ajax.request),$(document).pjax(".js-ajax-links a",window.iCarAsiaParameters.ajax.settings.display,window.iCarAsiaParameters.ajax.request),$(document).on("submit","form.smenu__form",(function(e){$.pjax.submit(e,window.iCarAsiaParameters.ajax.settings.display,window.iCarAsiaParameters.ajax.request)})),$(document).on("pjax:timeout",(function(e){return e.preventDefault(),!1})),$(document).on("pjax:error",(function(e){return e.preventDefault(),$(window.iCarAsiaParameters.ajax.settings.display).html((window.iCarAsiaParameters.ajaxifyError,window.iCarAsiaParameters.ajaxifyError)),!1})),$(document).on("pjax:success",(function(e){window.iCarAsiaParameters.ajax.settings.triggers.response(),gaPush({event:"SearchV4ChangeState"}),tmlPush({t:"paths"})})),$(document).on("pjax:send",(function(e){var a;!iCarSMenu.getMenuActive||(a=iCarSMenu.getMenuActive())&&a.dropdown.close(),window.iCarAsiaParameters.ajax.addLoader()})),$(document).on("pjax:complete",(function(e){e.preventDefault()})))})),$(document).ready((function(){function e(e,a){0===e&&(e=$('input[name="current_page"]').val());var t=$('input[name="current_page"]').val(),i=$('input[name="last_page"]').val();i&&i===t&&(e=t);var n=$('input[name="make"]').val(),r=$('input[name="model"]').val();$("span#make-reviews").text(n),$("span#model-reviews").text(r),$.ajax({url:"/ajax/reviews",data:{make:n,model:r,page:e},beforeSend:function(){$(".loading-screen").show()},success:function(e){$(".loading-screen").hide(),(1!==e.current_page?$("#user-review-comment-wrap"):$("#user-reviews-results")).append(e.view),e.current_page===e.last_page&&$("#user-review-more-div").hide(),$('#user-review-more-div input[name="current_page"]').val(e.current_page),"seeAllReviews"===a?gaPush({event:"custom_track",eventCategory:"User Reviews",eventAction:"See All Reviews Click",eventLabel:[n+" & "+r]}):gaPush({event:"custom_track",eventCategory:"User Reviews",eventAction:"Load More Reviews Click",eventLabel:[n+" & "+r]})}})}$("body").on("click","#review-popup",(function(a){var t,i;void 0!==$(".modal--userreview")[1]&&$(".modal--userreview")[1].remove(),$("body .modal__body #user-reviews-results").html(""),$("body .modal__body #user-review-overall").html(""),t=$('input[name="make"]').val(),i=$('input[name="model"]').val(),$.ajax({url:"/ajax/rating",data:{make:t,model:i},success:function(e){$("#user-review-overall").append(e)}}),e(0,"seeAllReviews")})),$("body").on("click","#js-review-more",(function(){e(+$('#user-review-more-div input[name="current_page"]').val()+1,"loadMoreReviews")})),$("body").on("click","#user_helpful_report",(function(){var e=$(this).attr("data-id");$('.js-review-report input[name="review_id"]').val(e),$(".report-done").addClass("visuallyhidden"),$(".report-form-body").removeClass("visuallyhidden")})),$("body").on("click","#userreview-report",(function(){var e,a;e=$('input[name="report"]').val(),a=$('input[name="review_id"]').val(),$.ajax({url:"/ajax/reportreview",data:{report:e,review_id:window.iCarWidgets.slugify(a)},success:function(e){$(".report-done").removeClass("visuallyhidden"),$(".report-form-body").addClass("visuallyhidden"),$(".js-user-review-control-"+a+" .js-user-helpful-report").removeClass("js-bpopup"),$(".js-user-review-control-"+a+" .js-user-helpful-report").removeAttr("data-target"),$(".js-user-review-control-"+a+" .js-user-helpful-report").attr("disabled",!0),$(".js-user-review-control-"+a+" .js-reporting-icon").addClass("icon--danger")}})})),$("body").on("click",".js-review-helpful",(function(){var e=$(this).attr("data-id"),a="increment";$(".js-review-helpful-"+e+" .icon--thumb-up").hasClass("btn--checked")?($(".js-review-helpful-"+e+" .icon--thumb-up").removeClass("btn--checked"),a="decrement"):$(".js-review-helpful-"+e+" .icon--thumb-up").addClass("btn--checked"),function(e,a){var t=$('input[name="make"]').val(),i=$('input[name="model"]').val();$.ajax({url:"/ajax/reviewhelpful",data:{review_id:window.iCarWidgets.slugify(e),action:window.iCarWidgets.slugify(a)},success:function(a){0===(a=a.helpful_count)&&(a="0"),$("span#helpful-count-"+e).text(a),gaPush({event:"custom_track",eventCategory:"User Reviews",eventAction:"Helpful Click",eventLabel:[t+" & "+i]})}})}(e,a)})),$("body").on("click",".js-more-less-toggler",(function(){var e=$(this).attr("data-id");$(".js-more-"+e).toggleClass("visuallyhidden"),$(".js--short-deatil-"+e).toggleClass("visuallyhidden"),$($(this).attr("data-target")).toggleClass("visuallyhidden")})),$("body").on("click","#create-review a",(function(){var e=$('input[name="make"]').val(),a=$('input[name="model"]').val();gaPush({event:"custom_track",eventCategory:"User Reviews",eventAction:"Create Review Click",eventLabel:[e+" & "+a]})}))}));