function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,a){for(var n=0;n<a.length;n++){var s=a[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,a,n){return a&&_defineProperties(e.prototype,a),n&&_defineProperties(e,n),e}window.iCarAsiaParameters={countryCode:"my",mediaQueryDesktop:"(min-width: 1080px)",mediaQueryMobile:"(max-width: 767px)",mediaQueryTablet:"(min-width: 768px) and (max-width: 1079px)",mediaQueryPortable:"(max-width: 1079px)",reCaptchaKey:"6LdBqgMTAAAAAHdCaGb82tTUuNMOtrwKLxHro7NU",googleMapKey:"AIzaSyAmILzB5FTWNTwYpRE__bc5YBKMm69Qpwg",fbAppId:"1477024542562496",fbAppIdDev:"795961051292603",currencyCode:"RM",currencyPrefix:!0,compareLimit:4,mobile:{compareLimit:4},CTRModalPhoneRegex:{find:/^(01[0-9]|1300|00|0[2-9])(\d)/,replace:"$1-$2"},phonePrefix:"60",detailPageUrlPrefix:"{type}-cars"},window.iCarConfig={social:{facebook:{appId:"www"===window.location.hostname.split(".")[0]||"www1"===window.location.hostname.split(".")[0]?window.iCarAsiaParameters.fbAppId:window.iCarAsiaParameters.fbAppIdDev},googlePlus:{clientId:"260499326012-g6u8obescaj2f4aqvmq6k23pdch30tja"}},chatProtocol:{active:2},debug:{mode:1,file:null}};var AuthView=function(){function e(){_classCallCheck(this,e),app.info("Authentication View","auth-view"),this.authLinkEle=$("[data-auth]"),this.authAvailable=!!this.authLinkEle,this.loginEle=$(".js-chat-login"),this.signupEle=$(".js-chat-signup"),this.loadingEle=$(".js-auth-loading"),this.isPopup=!1,this.chatEnabled=!1,this.isLoggedIn=!1,this.saveCar=!1,this.saveCarListingId=0,this.track="",this.source="",this.loginFromLocation="",this.postAction="",this.sponsor=""}return _createClass(e,[{key:"bindEvents",value:function(){app.info("Bind Events","auth-view"),app.info(this.authAvailable,"auth-view"),this.eventOpenLogin(),this.eventToggles(),this.eventToggleLoginSignup(),this.eventCallbackAuthenticate()}},{key:"setFocusFirstField",value:function(){setTimeout((function(){$(".js-screen-active input").eq(0).focus()}),1e3)}},{key:"eventToggleLoginSignup",value:function(){var e=this;$(".modal--auth .js-form-pointer").click((function(){$(".modal--auth .js-login").length&&$(".modal--auth .modal__title").html($(".js-screen-active .chat-form__head .flexbox__item:first").text()),e.setFocusFirstField()}))}},{key:"eventToggles",value:function(){var e=this;$(".js-show-login").click((function(a){return e.showLogin(e),!1})),$(".js-show-signup").click((function(a){return e.showSignup(e),!1}))}},{key:"showLogin",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;app.log("Show Login","auth-view"),(e=null!==e?e:this).loginFromLocation="login",$(".js-screen-active").toggleClass("visuallyhidden u-hide js-screen-active"),e.loginEle.removeClass("visuallyhidden u-hide").addClass("js-screen-active")}},{key:"showSignup",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;app.log("Show Signup","auth-view"),(e=null!==e?e:this).loginFromLocation="signup",$(".js-screen-active").toggleClass("visuallyhidden u-hide js-screen-active"),e.signupEle.removeClass("visuallyhidden u-hide").addClass("js-screen-active")}},{key:"redirectDealer",value:function(e){if("Private"!=e.info.profileType&&"login"===this.loginFromLocation)return setTimeout((function(){window.location.href=e.info.dealerHomeUrl}),500),0}},{key:"eventOpenLogin",value:function(){var e;app.info("eventOpenLogin","auth-view"),this.authAvailable&&(e=this,$("body").on("click","[data-auth]",(function(a){if(e.isLoggedIn)return!0;a.preventDefault(),a=$(this).data("auth"),$(this).data("auth_post"),e.loginFromLocation=a,e.source="Header","saveCar"==a&&(e.source="Save Car",e.saveCar=!0,e.saveCarListingId=$(this).data("ga-click-id")),e.showPopup(a),e.isPopup=!0})))}},{key:"moveToContainer",value:function(e){app.log("Move to container","auth-view"),this.loginFromLocation=e,$(".".concat(e)).length?(console.info("Moving to container, "+e,"auth-view"),$(".js-login").appendTo(".".concat(e)),$(".js-signup").insertAfter(".js-login"),$(".js-profile-update-modal__form").insertAfter(".js-signup"),$(".chat-container .b-close").addClass("js-chat-close")):console.info("Error, container not found.","auth-view")}},{key:"showPopup",value:function(e){var a=$(".modal--auth"),n=$(".modal__body",a);$(".js-login",a).length||($(".js-login").appendTo(n),$(".js-signup").appendTo(n)),$(".js-login").length&&($(".chat-form__head",a).addClass("visuallyhidden"),console.info("authModalBody","auth-view"),"signup"==e?(this.track="register",$(".js-login",n).addClass("visuallyhidden u-hide").removeClass("js-screen-active"),$(".js-signup",n).removeClass("visuallyhidden u-hide").addClass("js-screen-active")):(this.track="login",$(".js-signup",n).addClass("visuallyhidden u-hide").removeClass("js-screen-active"),$(".js-login",n).removeClass("visuallyhidden u-hide").addClass("js-screen-active")),gaPush({event:this.track+"_modal",eventSource:this.source}),$(".modal__title",a).html($(".js-screen-active .chat-form__head .flexbox__item:first").text()),$(".js-chat-close",a).addClass("visibility--hidden")),a.removeClass("visuallyhidden");var s=this,o=$("html, body, main"),i=!o.hasClass("no--overflow");window.iCarWidgets.popup.current=a.bPopup({modalClose:!1,positionStyle:"fixed",position:["35%","10%"],onOpen:function(){s.chatEnabled&&window.iCarWidgets.chat.isOpen&&$(".js-chat-close").click(),$(".js-register-dealer").removeClass("visuallyhidden"),$("html, body, main").addClass("no--overflow"),window.iCarWidgets.popup.onOpen("modal--auth"),s.setFocusFirstField()},onClose:function(){var e,n;$(".icarsuite_login").addClass("visuallyhidden  u-hide"),$(".nitro_dealer_login").addClass(" visuallyhidden u-hide"),s.saveCar&&s.isLoggedIn&&$('[data-save][data-ga-click-id="'+s.saveCarListingId+'"]').length&&(e=s.saveCarListingId,setTimeout((function(){var a,n=$('[data-save][data-ga-click-id="'+e+'"]');n.length&&(a=n.attr("data-car-id"),"undefined"!==_typeof(a)&&!1!==a||n.click())}),3e3)),"Update Profile"===$(".modal--auth > .modal__container > .modal__head > .modal__title").text()&&(n={action:"signup",status:1,info:{displayName:$(".js-profile-update-modal__form").find("#full_name_signup").val(),email:$(".js-profile-update-modal__form").find("#user_name_signup").val()}},window.authSuccess(n)),s.saveCar=!1,s.saveCarListingId=0,s.track="",s.source="",$(".js-register-dealer").addClass("visuallyhidden"),$(".modal--auth .js-chat-close").removeClass("visibility--hidden"),$(".modal--auth .js-login").addClass("visuallyhidden").removeClass("js-screen-active"),$(".modal--auth .js-signup").addClass("visuallyhidden").removeClass("js-screen-active"),i&&o.removeClass("no--overflow"),$(".chat-form__head",a).removeClass("visuallyhidden"),window.iCarWidgets.popup.onClose(),s.isPopup=!1}})}},{key:"showProfileUpdateForm",value:function(e){this.authForm=$(".auth-form"),this.authForm.addClass("visuallyhidden"),this.updateProfileBlock=$(".js-profile-update-modal__form"),this.updateProfileBlock.removeClass("visuallyhidden  u-hide"),$(".js-profile-update-modal__form #full_name").val(e.displayName),""===e.displayName||void 0===e.displayName||null===e.displayName?($(".js-profile-update-modal__form .js-chat-update-profile-name-block").removeClass("visuallyhidden"),$(".js-profile-update-modal__form #full_name").addClass("js-form-element-required")):($(".js-profile-update-modal__form .js-chat-update-profile-name-block").addClass("visuallyhidden"),$(".js-profile-update-modal__form #full_name").removeClass("js-form-element-required")),$(".js-profile-update-modal__form #chat_profile_update_email").val(e.email),""===e.email||void 0===e.email||null===e.email?($(".js-profile-update-modal__form .js-chat-update-profile-email-block").removeClass("visuallyhidden"),$(".js-profile-update-modal__form #chat_profile_update_email").addClass("js-form-element-required")):($(".js-profile-update-modal__form .js-chat-update-profile-email-block").addClass("visuallyhidden"),$(".js-profile-update-modal__form #chat_profile_update_email").removeClass("js-form-element-required")),$(".js-profile-update-modal__form #phone_number_signup").val(e.phone),""===e.phone||void 0===e.phone||null===e.phone?($(".js-profile-update-modal__form .js-chat-update-profile-phone-block").removeClass("visuallyhidden"),$(".js-profile-update-modal__form #phone_number_signup").addClass("js-form-element-required")):($(".js-profile-update-modal__form .js-chat-update-profile-phone-block").addClass("visuallyhidden"),$(".js-profile-update-modal__form #phone_number_signup").removeClass("js-form-element-required")),$('input[name="userId"]').val(e.id)}},{key:"isProfileComplete",value:function(e){return""!==e.displayName&&void 0!==e.displayName&&""!==e.phone&&void 0!==e.phone&&""!==e.email&&void 0!==e.email}},{key:"eventCallbackAuthenticate",value:function(){var e=this;window.authLoader=function(){e.showLoader()},window.authSuccess=function(a){var n;-1<window.location.href.indexOf("forgotpassword")&&window.location.replace("/"),e.hideLoader(),e.postAction=$(".js-sponsors .form-actions .btn--primary").data("auth_post"),1==a.status?(app.log("Login or Signup successful","auth-view"),e.isLoggedIn=!0,(new HeaderView).render(a),$("body").removeClass("support--off-logout"),e.chatEnabled&&ChatSession.manager.getChatUser(!e.isPopup),!1===e.isProfileComplete(a.info)&&e.showProfileUpdateForm(a.info),(n=new SavedCarsView).hasSavedCars()&&n.getSavedCars(),e.redirectDealer(a),void 0!==$(".js-contact-action").attr("data-contact-action")&&(n=0,1<a.info.displayName.length&&1<a.info.email.length&&a.info.phone&&1<a.info.phone.toString().length&&(n=1),$(".js-user-signin").remove(),$(".js-terms").removeClass("visuallyhidden"),window.iCarCTRMethod.updateProfileData&&(a.info.name=a.info.displayName,iCarCTRMethod.updateProfileData(a.info)),$(".js-is-profile-complete").data("profile_name",a.info.displayName).data("profile_email",a.info.email).data("profile_phone",a.info.phone).data("is_profile_complete",n)),console.log("after js-update-profile check"),e.isPopup&&(gaPush({event:e.track+"_success",eventSource:e.source}),window.iCarWidgets.popup.current.close())):(app.log("Login or Signup Error","auth-view"),$(".js-form-error-common",window.dataForm).html(a.errors).removeClass("visuallyhidden  u-hide"))},window.authFailure=function(a,n,s){var o=$(".js-form-error-common",window.dataForm),i=$(".icarsuite_login");try{var t=a.responseJSON;"Dealer Login"===t.action||"Sales Agent Login"===t.action||"Broker Login"===t.action?(i.removeClass("visuallyhidden  u-hide"),$(".auth-form").addClass("visuallyhidden  u-hide"),$(".nitro_dealer_login").removeClass("visuallyhidden u-hide")):(t&&"object"===_typeof(t)&&t.errors?o.html(t.errors):o).removeClass("visuallyhidden  u-hide")}catch(a){o.html(s).removeClass("visuallyhidden  u-hide")}e.hideLoader()},window.chatProfileUpdateSuccess=function(e,a,n){$(".js-profile-update-modal__form").addClass("visuallyhidden"),$(".js-profile-update-modal__form").find(".button__update").attr("enabled",!0),$(".profile-update-backdrop").remove(),$("body").removeClass("profile-update-required"),(new HeaderView).render(e)},window.chatProfileUpdateFailure=function(e,a,n){var s=$(".js-form-error-common"),o=$.parseJSON(e.responseText);$(".js-profile-update-modal__form").find(".button__update").attr("enabled",!1),"object"==_typeof(o)&&s.html(e.responseJSON.message).removeClass("visuallyhidden")}}},{key:"showLoader",value:function(){this.chatEnabled&&!this.isPopup?ChatSession.chatDialogView.showLoader():this.loadingEle.removeClass("visuallyhidden u-hide")}},{key:"hideLoader",value:function(){this.chatEnabled&&!this.isPopup?ChatSession.chatDialogView.hideLoader():this.loadingEle.addClass("visuallyhidden u-hide")}}]),e}();function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,a){for(var n=0;n<a.length;n++){var s=a[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,a,n){return a&&_defineProperties(e.prototype,a),n&&_defineProperties(e,n),e}var FbHandler=function(){function e(){_classCallCheck(this,e),app.log("Loading SDK File","fb-handler");var a,n,s,o=(o=document.querySelector("meta[property='og:locale']").getAttribute("content"))||"en_US";n="facebook-jssdk",s=(a=document).getElementsByTagName("script")[0],a.getElementById(n)||((a=a.createElement("script")).id=n,a.src="//connect.facebook.net/"+o+"/sdk.js#xfbml=1&version=v2.6",s.parentNode.insertBefore(a,s))}return _createClass(e,[{key:"syncInit",value:function(){app.log("FB SyncInit","fb-handler"),window.fbAsyncInit=function(){FB.init({appId:window.iCarConfig.social.facebook.appId,cookie:!0,version:"v2.6"})}}},{key:"login",value:function(){app.log("Try FB Login","fb-handler");var e=this;FB.login((function(a){app.log("Call back for FB","fb-handler"),a.authResponse?(e.authToken=a.authResponse.accessToken,e.getUserInfo()):app.log("User cancelled login or did not fully authorize.")}),{scope:"public_profile,email,user_about_me"})}},{key:"statusChangeCallback",value:function(e){app.log("Status change callback","fb-handler"),app.log(e,"fb-handler"),"connected"===e.status?(app.log("Connected to FB","fb-handler"),this.authToken=e.authResponse.accessToken,this.getUserInfo()):"not_authorized"===e.status?app.log("Not Authorized","fb-handler"):app.log("Other error FB","fb-handler")}},{key:"checkLoginState",value:function(){var e=this;FB.getLoginStatus((function(a){e.statusChangeCallback(a)}))}},{key:"getUserInfo",value:function(){app.log("Get User Info","fb-handler");var e=this;FB.api("/me?fields=name,email",(function(a){app.log("Successful login for: "+a.name,"fb-handler"),app.log(a,"fb-handler");var n={};n.full_name=a.name,n.user_id=a.id,n.user_name=a.id,void 0!==a.email&&(n.user_name=a.email,n.email=a.email),n.auth_type="fb",n.auth_token=e.authToken,app.log("Response Data","fb-handler"),app.log(n,"fb-handler"),Auth.loginManager.login(n)}))}}]),e}();function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,a){for(var n=0;n<a.length;n++){var s=a[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,a,n){return a&&_defineProperties(e.prototype,a),n&&_defineProperties(e,n),e}var GplusHandler=function(){function e(){var a,n,s;_classCallCheck(this,e),app.log("Loading SDK File","gplus-handler"),n="google-jssdk",s=(a=document).getElementsByTagName("script")[0],a.getElementById(n)||((a=a.createElement("script")).id=n,a.src="//apis.google.com/js/platform.js?onload=onLoadCallback",s.parentNode.insertBefore(a,s))}return _createClass(e,[{key:"syncInit",value:function(){app.log("GPlus SyncInit","gplus-handler");var e=this;gapi.load("auth2",(function(){app.log("GAPI Load","gplus-handler"),e.auth2=gapi.auth2.init({client_id:window.googlePlusClientId+".apps.googleusercontent.com",cookiepolicy:"single_host_origin"}),app.log("Init Auth 2"+window.googlePlusClientId,"gplus-handler"),e.attachSignin(document.getElementById("login-gplus")),e.attachSignin(document.getElementById("login-gplus-signup"))}))}},{key:"attachSignin",value:function(e){app.log("Attach Signin","gplus-handler");var a=this;this.auth2.attachClickHandler(e,{},(function(e){a.statusChangeCallback(e)}),(function(e){a.statusFailed(JSON.stringify(e,void 0,2))}))}},{key:"statusChangeCallback",value:function(e){app.log("Status change callback","gplus-handler"),app.log(e,"gplus-handler");var a=e.getAuthResponse(!0),n=e.getBasicProfile();app.log("Successful login for: "+n.getGivenName(),"gplus-handler"),app.log(n,"gplus-handler"),(e={}).email=n.getEmail(),e.user_name=n.getEmail(),e.full_name=n.getGivenName(),e.user_id=n.getId(),e.auth_token=a.access_token,e.auth_type="google",app.log("Response","gplus-handler"),app.log(e,"gplus-handler"),Auth.loginManager.login(e)}},{key:"statusFailed",value:function(e){app.log("GPlus Handler Failed","gplus-handler")}}]),e}();function onLoadCallback(){Auth.loginManager.gplusHandler.syncInit()}function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,a){for(var n=0;n<a.length;n++){var s=a[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,a,n){return a&&_defineProperties(e.prototype,a),n&&_defineProperties(e,n),e}function _defineProperty(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}var GoneTapHandler=function(){function e(){var a,n,s;_classCallCheck(this,e),_defineProperty(this,"handleCredentialResponse",(function(e){var a={};a.auth_token=e.credential,a.auth_type="google-onetap",app.log("Response","gonetap-handler"),app.log(a,"gonetap-handler"),Auth.loginManager.login(a)})),app.log("Loading SDK File","g-onetap-handler"),n="google-onetap-jssdk",s=(a=document).getElementsByTagName("script")[0],a.getElementById(n)||((a=a.createElement("script")).id=n,a.src="//accounts.google.com/gsi/client",s.parentNode.insertBefore(a,s))}return _createClass(e,[{key:"syncInit",value:function(){var e=this;app.log("GOneTap SyncInit","gonetap-handler"),document.getElementById("google-onetap-jssdk").addEventListener("load",(function(){console.log("GOneTap script loaded...."),$(".js-loginbtn").length&&(google.accounts.id.initialize({client_id:window.googlePlusClientId+".apps.googleusercontent.com",callback:e.handleCredentialResponse}),google.accounts.id.prompt((function(e){console.log("Notification",e)})))}))}}]),e}();function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,a){for(var n=0;n<a.length;n++){var s=a[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,a,n){return a&&_defineProperties(e.prototype,a),n&&_defineProperties(e,n),e}var HeaderView=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"render",value:function(e){var a=$(".js-dealer-hub-header--action"),n=null;if($(".js-part-language-switcher").length&&(n=$(".js-part-language-switcher").parent().clone()),a.length&&(a.html($(e.dealer_hub_header_action).html()),$(".js-dealer-hub-header-mobile--action").html($(e.dealer_hub_header_action_mobile).html())),a=e.header,$(".js-desktop-menu").html($("<div>").html(a).find(".js-desktop-menu").html()),$(".js-mobile-menu").html($("<div>").html(a).find(".js-mobile-menu").html()),n&&n.length&&$(".js-part-language-switcher").length){var s,o=$(".js-part-language-switcher").parent().toArray();n=n.toArray();for(s in o)$(o[s]).replaceWith(n[s])}$(document).trigger("loggedin",e.info)}}]),e}();function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,a){for(var n=0;n<a.length;n++){var s=a[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,a,n){return a&&_defineProperties(e.prototype,a),n&&_defineProperties(e,n),e}var Login=function(){function e(){_classCallCheck(this,e),app.log("Initialize Login Object","login"),this.fbHandler=new FbHandler,this.gplusHandler=new GplusHandler,this.gonetapHandler=new GoneTapHandler,this.loginFbBtn=$(".js-login-fb"),this.loginGplusBtn=$(".js-login-gplus")}return _createClass(e,[{key:"fb",get:function(){return this.fbHandler}},{key:"gplus",get:function(){return this.gplusHandler}},{key:"gonetap",get:function(){return this.gonetapHandler}},{key:"bindEvents",value:function(){app.log("Bind Events","login");var e=this;this.loginFbBtn.click((function(){e.fbHandler.login()})),this.fbHandler.syncInit(),this.gonetapHandler.syncInit()}},{key:"login",value:function(e){app.log("Try Social Login","login"),e._csrf=$('[name="_csrf"]').val(),Auth.authView.showLoader(),$.ajax({url:"/ajax/signup",type:"POST",data:e,dataType:"json",success:function(e){window.authSuccess(e)},error:function(a,n,s){console.log("Callback method: failure fb/g+"),console.log("error",a),console.log("textStatus",n),window.authFailure(a,n,s),"google-onetap"===e.auth_type&&(Auth.authView.isPopup=!0,Auth.authView.showPopup())},complete:function(){Auth.authView.hideLoader()}})}},{key:"buildQuery",value:function(e){var a="";return"object"==_typeof(e)&&jQuery.each(e,(function(e,n){if(a+=a?"&":"","object"==_typeof(n)&&n.length)for(var s=0;s<n.length;s++)a+=[e+"[]",encodeURIComponent(n[s])].join("=");else a+=[e,encodeURIComponent(n)].join("=")})),a}}]),e}();function onSignup(e){alert(333)}function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,a){for(var n=0;n<a.length;n++){var s=a[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,a,n){return a&&_defineProperties(e.prototype,a),n&&_defineProperties(e,n),e}var SavedCarsView=function(){function e(){_classCallCheck(this,e),this.savedCars={count:0,savedCars:{}}}return _createClass(e,[{key:"getSavedCars",value:function(){app.log("Get saved cars","saved-cars-view");var e=this;$.ajax({url:"/ajax/saved",type:"GET",dataType:"json",success:function(a,n,s){e.savedCars=a,e.render()},error:function(){}})}},{key:"hasSavedCars",value:function(){return app.log("Has saved cars","saved-cars-view"),!!$("[data-save][data-ga-click-id]").length}},{key:"render",value:function(){var e=this;$("[data-save][data-ga-click-id]").each((function(){var a,n,s=$(this).attr("data-ga-click-id");void 0!==e.savedCars.savedCars[s]?(a=e.savedCars.savedCars[s],(n=$('[data-save][data-ga-click-id="'+s+'"]')).removeAttr("data-auth").attr("href","#").attr("data-id",s).attr("data-car-id",a).addClass("js-save-car").addClass("action-items__item--save-active").find("span").addClass("save-title").html(n.attr("data-saved"))):$('[data-save][data-ga-click-id="'+s+'"]').removeAttr("data-auth").attr("href","#").attr("data-id",s).addClass("js-save-car").find("span").addClass("save-title")})),app.log("Render","saved-cars-view")}}]),e}();function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var Auth=function e(){_classCallCheck(this,e)};app.info("Starting auth stuff","auth"),window.iCarAsiaParameters.authLanguage=window.params.authLanguage;var authView=new AuthView;authView.bindEvents(),Auth.authView=authView;var loginManager=new Login;loginManager.bindEvents(),Auth.loginManager=loginManager,app.info("Auth setup complete","auth"),$(document).ready((function(){$(".js-forgotpassword").on("submit",(function(e){e.preventDefault(),e=$("#user_name").val(),$.ajax({url:"/ajax/forgotpassword",type:"GET",data:{user_name:e,recovery_type:"all"},success:function(e,a,n){$(".js-forgotpassword").addClass("visuallyhidden"),$(".js-reset-sent").removeClass("visuallyhidden"),console.log("all.sendType: "+e.sendType),"phone"===e.sendType?($(".js-email-reminder").addClass("visuallyhidden"),$(".js-reset-sent--email").addClass("visuallyhidden"),$(".js-sms-reminder").removeClass("visuallyhidden"),$(".js-reset-sent--sms").removeClass("visuallyhidden"),$(".js-sendto").html(e.phone)):($(".js-email-reminder").removeClass("visuallyhidden"),$(".js-reset-sent--email").removeClass("visuallyhidden"),$(".js-sms-reminder").addClass("visuallyhidden"),$(".js-reset-sent--sms").addClass("visuallyhidden"),$(".js-sendto").html(e.emailaddress)),$(".js-sendto-confirmation").html(e.phone),""!==e.phone&&$(".js-sms").removeClass("visuallyhidden")},error:function(e,a,n){400===e.status&&(""!==e.responseJSON.message&&$(".c-form__error").html(e.responseJSON.message),$(".c-form__error").removeClass("visuallyhidden"))}})})),$(".js-email").on("click",(function(e){e.preventDefault(),e=$("#user_name").val(),$.ajax({url:"/ajax/forgotpassword",type:"GET",data:{user_name:e,recovery_type:"email"},success:function(e,a,n){$(".js-forgotpassword").addClass("visuallyhidden"),$(".js-reset-sent").removeClass("visuallyhidden"),console.log("email.sendType: "+e.sendType),"phone"===e.sendType?($(".js-email-reminder").addClass("visuallyhidden"),$(".js-reset-sent--email").addClass("visuallyhidden"),$(".js-sms-reminder").removeClass("visuallyhidden"),$(".js-reset-sent--sms").removeClass("visuallyhidden"),$(".js-sendto").html(e.phone)):($(".js-email-reminder").removeClass("visuallyhidden"),$(".js-reset-sent--email").removeClass("visuallyhidden"),$(".js-sms-reminder").addClass("visuallyhidden"),$(".js-reset-sent--sms").addClass("visuallyhidden"),$(".js-sendto").html(e.emailaddress)),""!==e.phone&&$(".js-sms").removeClass("visuallyhidden")},error:function(e,a,n){400===e.status&&e.responseJSON.message&&($(".c-form__error").html(e.responseJSON.message),$(".c-form__error").removeClass("visuallyhidden"))}})})),$(".js-sms").on("click",(function(e){e.preventDefault(),$(".js-reset-confirmation").removeClass("visuallyhidden"),$(".js-reset-sent").addClass("visuallyhidden")})),$(".js-confirmation-btn").on("click",(function(e){e.preventDefault(),e=$("#user_name").val(),$.ajax({url:"/ajax/forgotpassword",type:"GET",data:{user_name:e,recovery_type:"sms"},success:function(e,a,n){$(".js-forgotpassword").addClass("visuallyhidden"),$(".js-reset-sent").removeClass("visuallyhidden"),console.log("sms.sendType: "+e.sendType),"phone"===e.sendType?($(".js-email-reminder").addClass("visuallyhidden"),$(".js-reset-sent--email").addClass("visuallyhidden"),$(".js-reset-confirmation").addClass("visuallyhidden"),$(".js-sms-reminder").removeClass("visuallyhidden"),$(".js-reset-sent--sms").removeClass("visuallyhidden"),$(".js-sendto").html(e.phone)):($(".js-email-reminder").removeClass("visuallyhidden"),$(".js-reset-sent--email").removeClass("visuallyhidden"),$(".js-sms-reminder").addClass("visuallyhidden"),$(".js-reset-sent--sms").addClass("visuallyhidden"),$(".js-sendto").html(e.emailaddress)),""!==e.phone&&$(".js-sms").removeClass("visuallyhidden")},error:function(e,a,n){400===e.status&&e.responseJSON.message&&($(".c-form__error").html(e.responseJSON.message),$(".c-form__error").removeClass("visuallyhidden"))}})}))}));